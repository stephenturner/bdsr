<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Biological Data Science with R - 6&nbsp; Refresher: Tidy Exploratory Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rmarkdown.html" rel="next">
<link href="./ggplot2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./basics.html">Core lessons</a></li><li class="breadcrumb-item"><a href="./tidyeda.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Refresher: Tidy Exploratory Data Analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biological Data Science with R</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Biological-Data-Science-with-R.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Biological-Data-Science-with-R.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Core lessons</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tibbles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tibbles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Manipulation with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tidy Data and Advanced Data Manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyeda.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Refresher: Tidy Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reproducible Reporting with RMarkdown</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Electives</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Essential Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predmodeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Predictive Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probabilistic Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./textmining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Text Mining</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggtree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phylogenetic Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rnaseq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">RNA-seq</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview"><span class="header-section-number">6.1</span> Chapter overview</a></li>
  <li><a href="#horror-movies-profit" id="toc-horror-movies-profit" class="nav-link" data-scroll-target="#horror-movies-profit"><span class="header-section-number">6.2</span> Horror Movies &amp; Profit</a>
  <ul class="collapse">
  <li><a href="#about-the-data" id="toc-about-the-data" class="nav-link" data-scroll-target="#about-the-data"><span class="header-section-number">6.2.1</span> About the data</a></li>
  <li><a href="#import-and-clean" id="toc-import-and-clean" class="nav-link" data-scroll-target="#import-and-clean"><span class="header-section-number">6.2.2</span> Import and clean</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">6.2.3</span> Exploratory Data Analysis</a></li>
  <li><a href="#join-to-imdb-reviews" id="toc-join-to-imdb-reviews" class="nav-link" data-scroll-target="#join-to-imdb-reviews"><span class="header-section-number">6.2.4</span> Join to IMDB reviews</a></li>
  </ul></li>
  <li><a href="#college-majors-income" id="toc-college-majors-income" class="nav-link" data-scroll-target="#college-majors-income"><span class="header-section-number">6.3</span> College Majors &amp; Income</a>
  <ul class="collapse">
  <li><a href="#about-the-data-1" id="toc-about-the-data-1" class="nav-link" data-scroll-target="#about-the-data-1"><span class="header-section-number">6.3.1</span> About the data</a></li>
  <li><a href="#import-and-clean-1" id="toc-import-and-clean-1" class="nav-link" data-scroll-target="#import-and-clean-1"><span class="header-section-number">6.3.2</span> Import and clean</a></li>
  <li><a href="#exploratory-data-analysis-1" id="toc-exploratory-data-analysis-1" class="nav-link" data-scroll-target="#exploratory-data-analysis-1"><span class="header-section-number">6.3.3</span> Exploratory Data Analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tidyeda" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Refresher: Tidy Exploratory Data Analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="chapter-overview" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="chapter-overview"><span class="header-section-number">6.1</span> Chapter overview</h2>
<p>This is a refresher chapter designed to be read after completing all the chapters that came before it.</p>
<p>The data and analyses here were inspired by the <a href="https://github.com/rfordatascience/tidytuesday">Tidy Tuesday</a> project – a weekly social data project in R from the <a href="https://r4ds.had.co.nz/">R for Data Science</a> online learning community <a href="https://x.com/R4DScommunity">@R4DScommunity</a>.</p>
<p>We’re going to use two different data sets. One containing data on movie budgets and profits that was featured in a FiveThirtyEight article on horror movies and profits, and another with data on college majors and income from the American Community Survey.</p>
<p>Packages needed for this analysis are loaded below. If you don’t have one of these packages installed, simply install it once using <code>install.packages("PackageName")</code>. A quick note on the <strong>tidyverse</strong> package (https://www.tidyverse.org/): the tidyverse is a collection of other packages that are often used together. When you install or load tidyverse, you also install and load all the packages that we’ve used previously: dplyr, tidyr, ggplot2, as well as several others. Because we’ll be using so many different packages from the tidyverse collection, it’s more efficient load this “meta-package” rather than loading each individual package separately.</p>
<div class="cell" data-hash="tidyeda_cache/html/required-packages_c144b07dab68ec761de4b653f024c780">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll demonstrate some functionality from these other packages. They’re handy to have installed, but are not strictly required.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-2_b3bbd05a53ffae65e7da8cbc8519b19a">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="horror-movies-profit" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="horror-movies-profit"><span class="header-section-number">6.2</span> Horror Movies &amp; Profit</h2>
<section id="about-the-data" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="about-the-data"><span class="header-section-number">6.2.1</span> About the data</h3>
<p>The raw data can be downloaded here: <strong><a href="data/movies.csv">movies.csv</a></strong>.</p>
<p>This data was featured in the FiveThirtyEight article, <a href="https://fivethirtyeight.com/features/scary-movies-are-the-best-investment-in-hollywood/">“Scary Movies Are The Best Investment In Hollywood”</a>.</p>
<blockquote class="blockquote">
<p>“Horror movies get nowhere near as much draw at the box office as the big-time summer blockbusters or action/adventure movies – the horror genre accounts for only 3.7 percent of the total box-office haul this year – but there’s a huge incentive for studios to continue pushing them out.</p>
<p>The return-on-investment potential for horror movies is absurd. For example, “Paranormal Activity” was made for $450,000 and pulled in $194 million – 431 times the original budget. That’s an extreme, I-invested-in-Microsoft-when-Bill-Gates-was-working-in-a-garage case, but it’s not rare. And that’s what makes horror such a compelling genre to produce.”</p>
</blockquote>
<p>– Quote from <a href="https://twitter.com/WaltHickey">Walt Hickey</a> for fivethirtyeight article.</p>
<p>Data dictionary (data from <a href="https://www.the-numbers.com/">the-numbers.com</a>):</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-3_f175f3b9dbdcd6b0e25dbbc3b70b284f">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Header</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>release_date</code></td>
<td style="text-align: left;">month-day-year</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>movie</code></td>
<td style="text-align: left;">Movie title</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>production_budget</code></td>
<td style="text-align: left;">Money spent to create the film</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>domestic_gross</code></td>
<td style="text-align: left;">Gross revenue from USA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>worldwide_gross</code></td>
<td style="text-align: left;">Gross worldwide revenue</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>distributor</code></td>
<td style="text-align: left;">The distribution company</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mpaa_rating</code></td>
<td style="text-align: left;">Appropriate age rating by the US-based rating agency</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>genre</code></td>
<td style="text-align: left;">Film category</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="import-and-clean" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="import-and-clean"><span class="header-section-number">6.2.2</span> Import and clean</h3>
<p>If you haven’t already loaded the packages we need, go ahead and do that now.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-4_d011bd42d0df8bd8be9e051ffc032de1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, use the <code>read_csv()</code> function from <strong>readr</strong> (loaded when you load <strong>tidyverse</strong>), to read in the <strong><a href="data/movies.csv">movies.csv</a></strong> dataset into a new object called <code>mov_raw</code>.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-6_ffa3f860378c8d40616cc6ff8a8e12c0">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mov_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/movies.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mov_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s clean up the data a bit. Remember, construct your pipeline one step at a time first. Once you’re happy with the result, assign the results to a new object, <code>mov</code>.</p>
<ul>
<li>Get rid of the blank <code>X1</code> Variable.</li>
<li>Change release date into an actual date.</li>
<li>Calculate the return on investment as the <code>worldwide_gross/production_budget</code>.</li>
<li>Calculate the percentage of total gross as domestic revenue.</li>
<li>Get the year, month, and day out of the release date.</li>
<li>Remove rows where the revenue is $0 (unreleased movies, or data integrity problems), and remove rows missing information about the distributor. Go ahead and remove any data where the rating is unavailable also.</li>
</ul>
<div class="cell" data-hash="tidyeda_cache/html/cleanupmovies_b40f79625fc976d12de157ca319d1d87">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mov <span class="ot">&lt;-</span> mov_raw <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>...<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">release_date =</span> <span class="fu">mdy</span>(release_date)) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">roi =</span> worldwide_gross <span class="sc">/</span> production_budget) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_domestic =</span> domestic_gross <span class="sc">/</span> worldwide_gross) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(release_date)) <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(release_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">wday</span>(release_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(release_date)) <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(worldwide_gross <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(distributor)) <span class="sc">|&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mpaa_rating))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>mov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a look at the distribution of release date.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-7_4a935abb04757f8079370326d844076c">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mov, <span class="fu">aes</span>(year)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There doesn’t appear to be much documented berfore 1975, so let’s restrict (read: filter) the dataset to movies made since 1975. Also, we’re going to be doing some analyses by year, and since the data for 2018 is still incomplete, let’s remove all of 2018. Let’s get anything produced in 1975 and after (<code>&gt;=1975</code>) but before 2018 (<code>&lt;2018</code>). Add the final filter statement to the assignment, and make the plot again.</p>
<div class="cell" data-hash="tidyeda_cache/html/cleanup-final_b9b7446e844b3bf1ccd742e96d059a31">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mov <span class="ot">&lt;-</span> mov_raw <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>...<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">release_date =</span> <span class="fu">mdy</span>(release_date)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">roi =</span> worldwide_gross <span class="sc">/</span> production_budget) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_domestic =</span> domestic_gross <span class="sc">/</span> worldwide_gross) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(release_date)) <span class="sc">|&gt;</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(release_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">wday</span>(release_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(release_date)) <span class="sc">|&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(worldwide_gross <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(distributor)) <span class="sc">|&gt;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mpaa_rating)) <span class="sc">|&gt;</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1975</span> <span class="sc">&amp;</span> year <span class="sc">&lt;</span><span class="dv">2018</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>mov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">6.2.3</span> Exploratory Data Analysis</h3>
<p>Which days are movies released on? The dplyr <code>count()</code> function counts the number of occurances of a particular variable. It’s shorthand for a <code>group_by()</code> followed by <code>summarize(n=n())</code>. The <code>geom_col()</code> makes a bar chart where the height of the bar is the count of the number of cases, y, at each x position. Feel free to add labels if you want.</p>
<div class="cell" data-hash="tidyeda_cache/html/release-days_606bdcaa766209942713f9e858ede2b5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(day, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(day, n)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">"Number of movies released"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Which days are movies released on?"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @jaseziv"</span>) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/release-days-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Does the day a movie is release affect revenue? Make a boxplot showing the worldwide gross revenue for each day.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-8_94757e9b28d48f0b4e1ec1c0a25f79de">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>What about month? Just swap <code>day</code> for <code>month</code> in the code.</p>
<div class="cell" data-hash="tidyeda_cache/html/revenue-by-month_8bd575cb7c0379c98a55e0a4788efc54">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, worldwide_gross)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">col=</span><span class="st">"gray10"</span>, <span class="at">fill=</span><span class="st">"gray90"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Release month"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Worldwide gross revenue"</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Does the day a movie is release affect revenue?"</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @jaseziv"</span>) <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/revenue-by-month-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We could also get a quantitative look at the average revenue by day using a group-by summarize operation:</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-9_b39b46736d6a296f6cabdb741e2da7b7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rev=</span><span class="fu">mean</span>(worldwide_gross))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  day          rev
  &lt;ord&gt;      &lt;dbl&gt;
1 Sun    70256412.
2 Mon   141521289.
3 Tue   177233110.
4 Wed   130794183.
5 Thu   194466996.
6 Fri    90769834.
7 Sat    89889497.</code></pre>
</div>
</div>
<p>It looks like summer months and holiday months at the end of the year fare well. Let’s look at a table and run a regression analysis.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-10_2bcf4c71b9fde2e320cdbe0f46c4be26">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rev=</span><span class="fu">mean</span>(worldwide_gross))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-11_718c85c1c71d6ca2f20ad36d2e179a54">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month=</span><span class="fu">factor</span>(month, <span class="at">ordered=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(worldwide_gross<span class="sc">~</span>month, <span class="at">data=</span>_) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What does the worldwide movie market look like by decade? Let’s first group by year and genre and compute the sum of the worldwide gross revenue. After we do that, let’s plot a barplot showing year on the x-axis and the sum of the revenue on the y-axis, where we’re passing the genre variable to the <code>fill</code> aesthetic of the bar.</p>
<div class="cell" data-hash="tidyeda_cache/html/total-market-by-year_7f35f976b532b7f8a74d9027494b12ba">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, genre) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">revenue=</span><span class="fu">sum</span>(worldwide_gross)) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, revenue)) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>genre)) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">"Worldwide revenue"</span>, <span class="at">title=</span><span class="st">"Worldwide Film Market by Decade"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/total-market-by-year-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which distributors produce the highest grossing movies by genre? First let’s lump all distributors together into 5 major distributors with the most movies, lumping all others into an “Other” category. The <code>fct_lump</code> function from the <strong>forcats</strong> package (loaded with <strong>tidyverse</strong>) will do this for you. Take a look at just that result first. Then let’s plot a <code>geom_col()</code>, which plots the actual value of the thing we put on the y-axis (worldwide gross revenue in this case). Because <code>geom_col()</code> puts all the values on top of one another, the highest value will be the one displayed. Let’s add <code>position="dodge"</code> so they’re beside one another instead of stacked. We can continue to add additional things to make the plot pretty. I like the look of this better when we flip the coordinate system with <code>coord_flip()</code>.</p>
<div class="cell" data-hash="tidyeda_cache/html/highest-grossing-by-genre-by-distrib_5d0700aada9de7bb4454be8d7c49f765">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">distributor=</span><span class="fu">fct_lump</span>(distributor, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(distributor, worldwide_gross)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>genre), <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Worldwide revenue"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Which distributors produce the highest grossing movies by genre?"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @JamesCBorders"</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/highest-grossing-by-genre-by-distrib-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It looks like Universal made the highest-grossing action and adventure movies, while Warner Bros made the highest grossing horror movies.</p>
<p>But what about return on investment?</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-12_d738fb99bca35eb004216e654e3e46f1">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">roi=</span><span class="fu">mean</span>(roi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  genre       roi
  &lt;chr&gt;     &lt;dbl&gt;
1 Action     2.82
2 Adventure  3.60
3 Comedy     3.48
4 Drama      3.40
5 Horror    11.2 </code></pre>
</div>
</div>
<p>It looks like horror movies have overwhelmingly the highest return on investment. Let’s look at this across the top distributors.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Modify the code above to look at return on investment instead of worldwide gross revenue.</p>
<div class="cell" data-hash="tidyeda_cache/html/highest-roi-by-genre-by-distrib_84d9108f25532c9870a2a9b5d8cdd38e">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/highest-roi-by-genre-by-distrib-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>Let’s make a scatter plot showing the worldwide gross revenue over the production budget. Let’s make the size of the point relative to the ROI. Let’s add a “breakeven” line that has a slope of 1 and a y-intercept of zero. Let’s facet by genre.</p>
<div class="cell" data-hash="tidyeda_cache/html/scatter-rev-by-budget_f180e19213ceaff89d1072aa0f2550da">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(production_budget, worldwide_gross)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> roi)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> genre) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Production Budget"</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Worldwide gross revenue"</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Return on Investment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/scatter-rev-by-budget-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Generally most of the points lie above the “breakeven” line. This is good – if movies weren’t profitable they wouldn’t keep making them. Proportionally there seem to be many more larger points in the Horror genre, indicative of higher ROI.</p>
<p>Let’s create a faceted grid showing distributor by genre. Paramount and Other distributors have the largest share of low-budget high-revenue horror films.</p>
<div class="cell" data-hash="tidyeda_cache/html/scatter-rev-by-budget-grid_c84732e73037fe9f5a9006b2f8f7adee">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">distributor =</span> <span class="fu">fct_lump</span>(distributor, <span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(production_budget, worldwide_gross)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> roi)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(distributor <span class="sc">~</span> genre) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Production Budget"</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Worldwide gross revenue"</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Return on Investment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/scatter-rev-by-budget-grid-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>What were those super profitable movies? Looks like they’re mostly horror movies. One thing that’s helpful to do here is to make movies a factor variable, reordering its levels by the median ROI. Look at the help for <code>?fct_reorder</code> for this. I also like to <code>coord_flip()</code> this plot.</p>
<div class="cell" data-hash="tidyeda_cache/html/bar-most-profitable-movies_6a4153d50c18bc81f301df90f2a08252">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(roi)) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">movie=</span><span class="fu">fct_reorder</span>(movie, roi)) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(movie, roi)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>genre)) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Movie"</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Return On Investment"</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Top 20 most profitable movies"</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @DaveBloom11"</span>) <span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">paste0</span>(<span class="fu">round</span>(roi), <span class="st">"x "</span>), <span class="at">hjust=</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/bar-most-profitable-movies-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It might be informative to run the same analysis for movies that had either exclusive US distribution, or no US distribution at all. We could simply filter for movies with 100% of the revenue coming from domestic gross revenue US only, or 0% from domestic (no US distribution). Just add a filter statement in the pipeline prior to plotting.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-13_a8f1848e74cb8fd39b13dd53f6dc7b92">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_domestic<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(roi)) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">movie=</span><span class="fu">fct_reorder</span>(movie, roi)) <span class="sc">|&gt;</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(movie, roi)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>genre)) <span class="sc">+</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Movie"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Return On Investment"</span>, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Top 20 most profitable movies with US-only distribution"</span>, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @DaveBloom11"</span>) <span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">paste0</span>(<span class="fu">round</span>(roi), <span class="st">"x "</span>), <span class="at">hjust=</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-14_46799f758012e51fa1a5e44cf40a9995">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_domestic<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(roi)) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">movie=</span><span class="fu">fct_reorder</span>(movie, roi)) <span class="sc">|&gt;</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(movie, roi)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>genre)) <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Movie"</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Return On Investment"</span>, </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Top 20 most profitable movies with no US distribution"</span>, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @DaveBloom11"</span>) <span class="sc">+</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What about movie ratings? R-rated movies have a lower average revenue but ROI isn’t substantially less. The <code>n()</code> function is a helper function that just returns the number of rows for each group in a grouped data frame. We can see that while G-rated movies have the highest mean revenue, there were relatively few of them produced, and had a lower total revenue. There were more R-rated movies, but PG-13 movies really drove the total revenue worldwide.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-15_5695f7893e1556133a824d71f7fc09b9">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mpaa_rating) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanrev =</span> <span class="fu">mean</span>(worldwide_gross),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">totrev =</span> <span class="fu">sum</span>(worldwide_gross),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">roi =</span> <span class="fu">mean</span>(roi),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="fu">n</span>()</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  mpaa_rating    meanrev       totrev   roi number
  &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;
1 G           189913348   13863674404  4.42     73
2 PG          147227422.  78324988428  4.64    532
3 PG-13       113477939. 120173136920  3.06   1059
4 R            63627931.  92451383780  4.42   1453</code></pre>
</div>
</div>
<p>Are there fewer R-rated movies being produced? Not really. Let’s look at the overall number of movies with any particular rating faceted by genre.</p>
<div class="cell" data-hash="tidyeda_cache/html/number-movies-by-genre-by-rating_41f2057f96261e8dc12932d80ffac3ea">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(mpaa_rating, genre) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mpaa_rating, n)) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>genre) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"MPAA Rating"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Number of films"</span>, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Number of films by rating for each genre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/number-movies-by-genre-by-rating-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about the distributions of ratings?</p>
<div class="cell" data-hash="tidyeda_cache/html/dist-movies-by-ratings_1c1f3625fa43ca8303d52c5103b721d0">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(worldwide_gross)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mpaa_rating) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Worldwide gross revenue"</span>, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Count"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Distribution of revenue by genre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/dist-movies-by-ratings-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/boxplot-revenue-by-ratings_a3d1855f47bfc86fcd5c8dc83da716dc">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mpaa_rating, worldwide_gross)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">col=</span><span class="st">"gray10"</span>, <span class="at">fill=</span><span class="st">"gray90"</span>) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"MPAA Rating"</span>, <span class="at">y=</span><span class="st">"Worldwide gross revenue"</span>, <span class="at">title=</span><span class="st">"Revenue by rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/boxplot-revenue-by-ratings-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>But, dont be fooled. Yes, on average G-rated movies look to perform better. But there aren’t that many of them being produced, and they aren’t bringing in the lions share of revenue.</p>
<div class="cell" data-hash="tidyeda_cache/html/count-ratings_10e694e5bbd45337b866cd84f021b18e">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(mpaa_rating) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mpaa_rating, n)) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"MPAA Rating"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Count"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Total number of movies produced for each rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/count-ratings-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/total-revenue-by-rating_7aa58326469ab6fa74c5ef4d0ce1d647">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mov <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mpaa_rating) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_revenue=</span><span class="fu">sum</span>(worldwide_gross)) <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mpaa_rating, total_revenue)) <span class="sc">+</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"MPAA Rating"</span>, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Total worldwide revenue"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Total worldwide revenue for each rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/total-revenue-by-rating-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="join-to-imdb-reviews" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="join-to-imdb-reviews"><span class="header-section-number">6.2.4</span> Join to IMDB reviews</h3>
<p>Look back at the <a href="https://dplyr.tidyverse.org/reference/join.html">dplyr reference on joins</a>. An inner join lets you take two tables, match by a common column (or columns), and return rows with an entry in both, returning all columns in each table. I’ve downloaded all the data underlying IMDB (<a href="https://www.imdb.com/interfaces/">imdb.com/interfaces</a>), and created a reduced dataset having ratings for all the movies in IMDB. Let’s join the movie data we have here with IMDB ratings. Download the data here: <strong><a href="data/movies_imdb.csv">movies_imdb.csv</a></strong>. Once you’ve downloaded it, read it in with <code>read_csv()</code>:</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-16_540939a35ad4f296481cd7223d4b064a">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>imdb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/movies_imdb.csv"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>imdb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are <strong>177,519</strong> movies in this dataset. There are <strong>3,117</strong> movies in the data we’ve already been using. Let’s see how many we have that intersect in both:</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-17_00f340eee280ac222d10ff3780c1ffb5">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>movimdb <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(mov, imdb, <span class="at">by=</span><span class="st">"movie"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>movimdb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It turns out there are only <strong>2,591</strong> rows in the joined dataset. That’s because there were some rows in <code>mov</code> that weren’t in <code>imdb</code>, and vice versa. Some of these are truly cases where there isn’t an entry in one. Others are cases where it’s <code>Star Wars Ep. I: The Phantom Menace</code> in one dataset but <code>Star Wars: Episode I - The Phantom Menace</code> in another, or <code>Mr. &amp; Mrs. Smith</code> versus <code>Mr. and Mrs. Smith</code>. Others might be ascii versus unicode text incompatibility, e.g.&nbsp;the hyphen “-” versus the endash, “–”.</p>
<p>Now that you have the datasets joined, try a few more exercises!</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Separately for each MPAA rating, display the mean IMDB rating and mean number of votes cast.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-18_edede1eb3f168e8fee44d001b735e9ac">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  mpaa_rating meanimdb meanvotes
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
1 G               6.54   132015.
2 PG              6.31    81841.
3 PG-13           6.25   102740.
4 R               6.58   107575.</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do the same but for each movie genre.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-19_2635d53d523247b0025edd65d7c1fbc3">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  genre     meanimdb meanvotes
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1 Action        6.28   154681.
2 Adventure     6.27   130027.
3 Comedy        6.08    71288.
4 Drama         6.88    91101.
5 Horror        5.90    89890.</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do the same but for each distributor, after lumping distributors in a mutate statement to the top 4 distributors, as we’ve done before.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-20_d851f1e929375c2f55c698851c5222f7">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  distributor        meanimdb meanvotes
  &lt;fct&gt;                 &lt;dbl&gt;     &lt;dbl&gt;
1 Paramount Pictures     6.44   130546.
2 Sony Pictures          6.25   111913.
3 Universal              6.44   130028.
4 Warner Bros.           6.37   133997.
5 Other                  6.46    86070.</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a boxplot visually summarizing what you saw in #1 and #2 above. That is, show the distribution of IMDB ratings for each genre, but map the fill aesthetic for the boxplot onto the MPAA rating. Here we can see that Dramas tend to get a higher IMDB rating overall. Across most categories R rated movies fare better. We also see from this that there are no Action or Horror movies rated G (understandably!). In fact, after this I actually wanted to see what the “Horror” movies were having a PG rating that seemed to do better than PG-13 or R rated Horror movies.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-21_e3f6140f22daa01f0790998670591c5d">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-22_a618d9592acf75d1be617684c17b6251">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>movimdb <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mpaa_rating<span class="sc">==</span><span class="st">"PG"</span>, genre<span class="sc">==</span><span class="st">"Horror"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(release_date, movie, worldwide_gross, imdb, votes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  release_date movie                    worldwide_gross  imdb  votes
  &lt;date&gt;       &lt;chr&gt;                              &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 2015-10-16   Goosebumps                     158905324   6.3  67744
2 1983-06-24   Twilight Zone: The Movie        29500000   6.5  29313
3 1982-06-04   Poltergeist                    121706019   7.4 124178
4 1978-06-16   Jaws 2                         208900376   5.7  61131
5 1975-06-20   Jaws                           470700000   8   492525</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a scatter plot of worldwide gross revenue by IMDB rating, with the gross revenue on a log scale. Color the points by genre. Add a trendline with <code>method="lm"</code>.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-23_2d0529645e2ca7b666be6928f64c2113">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 8
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create the same plot, this time putting the number of votes on the x-axis, and make both the x and y-axes log scale.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-24_efa60782eb1c7b43a3c5e36138768e5d">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 9
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create the above plots, but this time plot the ROI instead of the gross revenue.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-25_010565dbe5cb96c2f7b33e36390f5f55">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-26_6cf94d6693ae77a2820ffaa237018c9a">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 10
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is there a relationship between the release date and the IMDB ratings or votes cast? Surprisingly, there doesn’t appear to be one.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-27_4c65f984a233dc16e62714a3ed3b5ea5">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 11
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is there a relationship between the IMDB rating and the number of votes cast? It appears so, at least as you get toward the movies with the very largest number of ratings.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-28_d82caf26d77eca31c69281b07d0c4a7b">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 12
</div>
</div>
<div class="callout-body-container callout-body">
<p>Looking at that above plot, I’m interested in (a) what are those movies with the largest number of votes? and (b) what are those movies with at least 50,000 votes that have the worst scores?</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-29_9105403ef2155247ff1425e6063a4116">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>movimdb <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(votes)) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(release_date, movie, roi, imdb, votes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   release_date movie                      roi  imdb   votes
   &lt;date&gt;       &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 1994-09-23   The Shawshank Redemption  1.13   9.3 2009031
 2 1999-10-15   Fight Club                1.55   8.8 1607508
 3 1994-10-14   Pulp Fiction             26.6    8.9 1568242
 4 1994-07-06   Forrest Gump             12.4    8.8 1529711
 5 1999-03-31   The Matrix                7.13   8.7 1441344
 6 2014-11-05   Interstellar              4.05   8.6 1221035
 7 2005-06-15   Batman Begins             2.39   8.3 1149747
 8 2009-08-21   Inglourious Basterds      4.53   8.3 1070753
 9 1998-07-24   Saving Private Ryan       7.46   8.6 1058789
10 1993-12-15   Schindler's List         12.9    8.9 1036894</code></pre>
</div>
</div>
<p>No surprises there. These are some of the most universally loved films ever made. Interesting that the return on investment varies wildly (1.13x for the highest rated movie of all time, up to 26x for <em>Pulp Fiction</em>, which had to pay for an all-star cast).</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-30_b0b3d238bd617a3bca2c5f9318987bfa">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>movimdb <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votes<span class="sc">&gt;</span><span class="dv">50000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(imdb) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(release_date, movie, roi, imdb, votes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   release_date movie                      roi  imdb  votes
   &lt;date&gt;       &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2008-08-29   Disaster Movie           1.84    1.9  80918
 2 2007-01-26   Epic Movie               4.34    2.3  96271
 3 2006-02-17   Date Movie               4.26    2.8  53781
 4 2011-11-11   Jack and Jill            1.91    3.3  68909
 5 2004-07-23   Catwoman                 0.821   3.3  98513
 6 1997-06-20   Batman &amp; Robin           1.91    3.7 212085
 7 1997-06-13   Speed 2: Cruise Control  1.37    3.8  67296
 8 1994-12-23   Street Fighter           2.84    3.8  58912
 9 2015-02-13   Fifty Shades of Grey    14.3     4.1 269355
10 2010-07-01   The Last Airbender       2.13    4.1 133813</code></pre>
</div>
</div>
<p>Interesting that several of these having such terrible reviews still have fairly high return on investment (&gt;14x for <em>Fifty Shades of Grey</em>!).</p>
</div>
</div>
</section>
</section>
<section id="college-majors-income" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="college-majors-income"><span class="header-section-number">6.3</span> College Majors &amp; Income</h2>
<section id="about-the-data-1" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="about-the-data-1"><span class="header-section-number">6.3.1</span> About the data</h3>
<p>This is the data behind the FiveThirtyEight article, <a href="https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/">“The Economic Guide To Picking A College Major”</a>.</p>
<ul>
<li>All data is from American Community Survey 2010-2012 Public Use Microdata Series.</li>
<li>Original data and more: http://www.census.gov/programs-surveys/acs/data/pums.html.</li>
<li>Documentation: http://www.census.gov/programs-surveys/acs/technical-documentation/pums.html</li>
</ul>
<p>Data Dictionary:</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-31_b46d11cc649376e1cfaf7c1dc25a2614">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Header</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Rank</code></td>
<td style="text-align: left;">Rank by median earnings</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Major_code</code></td>
<td style="text-align: left;">Major code, FO1DP in ACS PUMS</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Major</code></td>
<td style="text-align: left;">Major description</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Major_category</code></td>
<td style="text-align: left;">Category of major from Carnevale et al</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Total</code></td>
<td style="text-align: left;">Total number of people with major</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Sample_size</code></td>
<td style="text-align: left;">Sample size (unweighted) of full-time, year-round ONLY (used for earnings)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Men</code></td>
<td style="text-align: left;">Male graduates</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Women</code></td>
<td style="text-align: left;">Female graduates</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ShareWomen</code></td>
<td style="text-align: left;">Women as share of total</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Employed</code></td>
<td style="text-align: left;">Number employed (ESR == 1 or 2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Full_time</code></td>
<td style="text-align: left;">Employed 35 hours or more</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Part_time</code></td>
<td style="text-align: left;">Employed less than 35 hours</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Full_time_year_round</code></td>
<td style="text-align: left;">Employed at least 50 weeks (WKW == 1) and at least 35 hours (WKHP &gt;= 35)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Unemployed</code></td>
<td style="text-align: left;">Number unemployed (ESR == 3)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Unemployment_rate</code></td>
<td style="text-align: left;">Unemployed / (Unemployed + Employed)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Median</code></td>
<td style="text-align: left;">Median earnings of full-time, year-round workers</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>P25th</code></td>
<td style="text-align: left;">25th percentile of earnigns</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>P75th</code></td>
<td style="text-align: left;">75th percentile of earnings</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>College_jobs</code></td>
<td style="text-align: left;">Number with job requiring a college degree</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Non_college_jobs</code></td>
<td style="text-align: left;">Number with job not requiring a college degree</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Low_wage_jobs</code></td>
<td style="text-align: left;">Number in low-wage service jobs</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="import-and-clean-1" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="import-and-clean-1"><span class="header-section-number">6.3.2</span> Import and clean</h3>
<p>If you haven’t already loaded the packages we need, go ahead and do that now.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-32_4995f9bb4c91e353c0a73e60eb24119a">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, use the <code>read_csv()</code> function from <strong>readr</strong> (loaded when you load <strong>tidyverse</strong>), to read in the <strong><a href="data/grads.csv">grads.csv</a></strong> dataset into a new object called <code>grads_raw</code>.</p>
<p>Read in the raw data.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-33_3cfe7056391a197bbf5fa640b11434ae">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>grads_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/grads.csv"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>grads_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now clean it up a little bit. Remember, construct your pipeline one step at a time first. Once you’re happy with the result, assign the results to a new object, <code>grads</code>.</p>
<ul>
<li>Make sure the data is arranged descending by Median income. It should be already, but don’t make any assumptions.</li>
<li>Make the Major sentence case so it’s not ALL CAPS. This uses the <code>str_to_title()</code> function from the <strong>stringr</strong> package, loaded with <strong>tidyverse</strong>.</li>
<li>Make it a factor variable with levels ordered according to median income.</li>
<li>Do the same for <code>Major_category</code> – make it a factor variable with levels ordered according to median income.</li>
<li>Add a new variable, <code>pct_college</code>, that’s the proportion of graduates employed in a job requiring a college degree. We’ll do some analysis with this later on to look at under-employment.</li>
<li>There’s one entry (“Military technologies”) that has no data about employment. This new variable is therefore missing. Let’s remove this entry.</li>
<li>There’s an entry with an unknown number of total majors, men, or women (“Food Science”). Let’s remove it by removing anything with a missing Total number.</li>
</ul>
<div class="cell" data-hash="tidyeda_cache/html/cleanupgrad_1fc06368cb1e465d1f3e31da2be30851">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>grads <span class="ot">&lt;-</span> grads_raw <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Median)) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major =</span> <span class="fu">str_to_title</span>(Major)) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major =</span> <span class="fu">fct_reorder</span>(Major, Median)) <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major_category =</span> <span class="fu">fct_reorder</span>(Major_category, Median)) <span class="sc">|&gt;</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_college=</span>College_jobs<span class="sc">/</span>(College_jobs<span class="sc">+</span>Non_college_jobs)) <span class="sc">|&gt;</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pct_college)) <span class="sc">|&gt;</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Total))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>grads</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis-1" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="exploratory-data-analysis-1"><span class="header-section-number">6.3.3</span> Exploratory Data Analysis</h3>
<p>Let’s start with an exercise.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 13
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remake table 1 from the <a href="https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/">FiveThirtyEight article</a>.</p>
<ul>
<li>Use the <code>select()</code> function to get only the columns you care about.</li>
<li>Use <code>head(10)</code> or <code>tail(10)</code> to show the first or last few rows.</li>
</ul>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-35_4b2c692f6052c848c003cfe5f820f168">
<div class="cell-output cell-output-stdout">
<pre><code>                                       Major    Major_category Total Median
1                      Petroleum Engineering       Engineering  2339 110000
2             Mining And Mineral Engineering       Engineering   756  75000
3                  Metallurgical Engineering       Engineering   856  73000
4  Naval Architecture And Marine Engineering       Engineering  1258  70000
5                       Chemical Engineering       Engineering 32260  65000
6                        Nuclear Engineering       Engineering  2573  65000
7                          Actuarial Science          Business  3777  62000
8                 Astronomy And Astrophysics Physical Sciences  1792  62000
9                     Mechanical Engineering       Engineering 91227  60000
10                    Electrical Engineering       Engineering 81527  60000</code></pre>
</div>
</div>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-36_dc4b657ef55fad254cbd8b31a8fd7956">
<div class="cell-output cell-output-stdout">
<pre><code>                                           Major            Major_category
1  Communication Disorders Sciences And Services                    Health
2                      Early Childhood Education                 Education
3                        Other Foreign Languages Humanities &amp; Liberal Arts
4                         Drama And Theater Arts                      Arts
5                       Composition And Rhetoric Humanities &amp; Liberal Arts
6                                        Zoology    Biology &amp; Life Science
7                         Educational Psychology  Psychology &amp; Social Work
8                            Clinical Psychology  Psychology &amp; Social Work
9                          Counseling Psychology  Psychology &amp; Social Work
10                               Library Science                 Education
   Total Median
1  38279  28000
2  37589  28000
3  11204  27500
4  43249  27000
5  18953  27000
6   8409  26000
7   2854  25000
8   2838  25000
9   4626  23400
10  1098  22000</code></pre>
</div>
</div>
</div>
</div>
<p>If you have the <strong>DT</strong> package installed, you can make an interactive table just like the one in the <a href="https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/">FiveThirtyEight article</a>.</p>
<div class="cell" data-hash="tidyeda_cache/html/datatable-538-1_ddc7906de85c396346fbd780ae7ce44e">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Major, Major_category, Total, Median) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-9e1be875f497f5b8ee24" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9e1be875f497f5b8ee24">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["Petroleum Engineering","Mining And Mineral Engineering","Metallurgical Engineering","Naval Architecture And Marine Engineering","Chemical Engineering","Nuclear Engineering","Actuarial Science","Astronomy And Astrophysics","Mechanical Engineering","Electrical Engineering","Computer Engineering","Aerospace Engineering","Biomedical Engineering","Materials Science","Engineering Mechanics Physics And Science","Biological Engineering","Industrial And Manufacturing Engineering","General Engineering","Architectural Engineering","Court Reporting","Computer Science","Electrical Engineering Technology","Materials Engineering And Materials Science","Management Information Systems And Statistics","Civil Engineering","Construction Services","Operations Logistics And E-Commerce","Miscellaneous Engineering","Public Policy","Environmental Engineering","Engineering Technologies","Miscellaneous Fine Arts","Geological And Geophysical Engineering","Nursing","Finance","Economics","Business Economics","Industrial Production Technologies","Nuclear, Industrial Radiology, And Biological Technologies","Accounting","Mathematics","Computer And Information Systems","Physics","Medical Technologies Technicians","Information Sciences","Statistics And Decision Science","Applied Mathematics","Pharmacology","Oceanography","Engineering And Industrial Management","Medical Assisting Services","Mathematics And Computer Science","Computer Programming And Data Processing","Cognitive Science And Biopsychology","School Student Counseling","International Relations","General Business","Architecture","International Business","Pharmacy Pharmaceutical Sciences And Administration","Molecular Biology","Miscellaneous Business &amp; Medical Administration","Agriculture Production And Management","General Agriculture","Miscellaneous Engineering Technologies","Mechanical Engineering Related Technologies","Genetics","Miscellaneous Social Sciences","United States History","Industrial And Organizational Psychology","Agricultural Economics","Physical Sciences","Chemistry","Electrical, Mechanical, And Precision Technologies And Production","Business Management And Administration","Marketing And Marketing Research","Political Science And Government","Geography","Microbiology","Computer Administration Management And Security","Biochemical Sciences","Botany","Computer Networking And Telecommunications","Geology And Earth Science","Human Resources And Personnel Management","Pre-Law And Legal Studies","Miscellaneous Health Medical Professions","Public Administration","Geosciences","Social Psychology","Environmental Science","Communications","Criminal Justice And Fire Protection","Commercial Art And Graphic Design","Journalism","Multi-Disciplinary Or General Science","Advertising And Public Relations","Area Ethnic And Civilization Studies","Special Needs Education","Physiology","Criminology","Nutrition Sciences","Health And Medical Administrative Services","Communication Technologies","Transportation Sciences And Technologies","Natural Resources Management","Neuroscience","Multi/Interdisciplinary Studies","Atmospheric Sciences And Meteorology","Forestry","Soil Science","General Education","History","French German Latin And Other Common Foreign Language Studies","Intercultural And International Studies","Social Science Or History Teacher Education","Community And Public Health","Mathematics Teacher Education","Educational Administration And Supervision","Health And Medical Preparatory Programs","Miscellaneous Biology","Biology","Sociology","Mass Media","Treatment Therapy Professions","Hospitality Management","Language And Drama Education","Linguistics And Comparative Language And Literature","Miscellaneous Education","Interdisciplinary Social Sciences","Ecology","Secondary Teacher Education","General Medical And Health Services","Philosophy And Religious Studies","Art And Music Education","English Language And Literature","Elementary Education","Physical Fitness Parks Recreation And Leisure","Liberal Arts","Film Video And Photographic Arts","General Social Sciences","Plant Science And Agronomy","Science And Computer Teacher Education","Psychology","Music","Physical And Health Education Teaching","Art History And Criticism","Fine Arts","Family And Consumer Sciences","Social Work","Animal Sciences","Visual And Performing Arts","Teacher Education: Multiple Levels","Miscellaneous Psychology","Human Services And Community Organization","Humanities","Theology And Religious Vocations","Studio Arts","Cosmetology Services And Culinary Arts","Miscellaneous Agriculture","Anthropology And Archeology","Communication Disorders Sciences And Services","Early Childhood Education","Other Foreign Languages","Drama And Theater Arts","Composition And Rhetoric","Zoology","Educational Psychology","Clinical Psychology","Counseling Psychology","Library Science"],["Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Business","Physical Sciences","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Law &amp; Public Policy","Computers &amp; Mathematics","Engineering","Engineering","Business","Engineering","Industrial Arts &amp; Consumer Services","Business","Engineering","Law &amp; Public Policy","Engineering","Engineering","Arts","Engineering","Health","Business","Social Science","Business","Engineering","Physical Sciences","Business","Computers &amp; Mathematics","Computers &amp; Mathematics","Physical Sciences","Health","Computers &amp; Mathematics","Computers &amp; Mathematics","Computers &amp; Mathematics","Biology &amp; Life Science","Physical Sciences","Engineering","Health","Computers &amp; Mathematics","Computers &amp; Mathematics","Biology &amp; Life Science","Education","Social Science","Business","Engineering","Business","Health","Biology &amp; Life Science","Business","Agriculture &amp; Natural Resources","Agriculture &amp; Natural Resources","Engineering","Engineering","Biology &amp; Life Science","Social Science","Humanities &amp; Liberal Arts","Psychology &amp; Social Work","Agriculture &amp; Natural Resources","Physical Sciences","Physical Sciences","Industrial Arts &amp; Consumer Services","Business","Business","Social Science","Social Science","Biology &amp; Life Science","Computers &amp; Mathematics","Biology &amp; Life Science","Biology &amp; Life Science","Computers &amp; Mathematics","Physical Sciences","Business","Law &amp; Public Policy","Health","Law &amp; Public Policy","Physical Sciences","Psychology &amp; Social Work","Biology &amp; Life Science","Communications &amp; Journalism","Law &amp; Public Policy","Arts","Communications &amp; Journalism","Physical Sciences","Communications &amp; Journalism","Humanities &amp; Liberal Arts","Education","Biology &amp; Life Science","Social Science","Health","Health","Computers &amp; Mathematics","Industrial Arts &amp; Consumer Services","Agriculture &amp; Natural Resources","Biology &amp; Life Science","Interdisciplinary","Physical Sciences","Agriculture &amp; Natural Resources","Agriculture &amp; Natural Resources","Education","Humanities &amp; Liberal Arts","Humanities &amp; Liberal Arts","Humanities &amp; Liberal Arts","Education","Health","Education","Education","Health","Biology &amp; Life Science","Biology &amp; Life Science","Social Science","Communications &amp; Journalism","Health","Business","Education","Humanities &amp; Liberal Arts","Education","Social Science","Biology &amp; Life Science","Education","Health","Humanities &amp; Liberal Arts","Education","Humanities &amp; Liberal Arts","Education","Industrial Arts &amp; Consumer Services","Humanities &amp; Liberal Arts","Arts","Social Science","Agriculture &amp; Natural Resources","Education","Psychology &amp; Social Work","Arts","Education","Humanities &amp; Liberal Arts","Arts","Industrial Arts &amp; Consumer Services","Psychology &amp; Social Work","Agriculture &amp; Natural Resources","Arts","Education","Psychology &amp; Social Work","Psychology &amp; Social Work","Humanities &amp; Liberal Arts","Humanities &amp; Liberal Arts","Arts","Industrial Arts &amp; Consumer Services","Agriculture &amp; Natural Resources","Humanities &amp; Liberal Arts","Health","Education","Humanities &amp; Liberal Arts","Arts","Humanities &amp; Liberal Arts","Biology &amp; Life Science","Psychology &amp; Social Work","Psychology &amp; Social Work","Psychology &amp; Social Work","Education"],[2339,756,856,1258,32260,2573,3777,1792,91227,81527,41542,15058,14955,4279,4321,8925,18968,61152,2825,1148,128319,11565,2993,18713,53153,18498,11732,9133,5978,4047,3600,3340,720,209394,174506,139247,13302,4631,2116,198633,72397,36698,32142,15914,11913,6251,4939,1762,2418,2906,11123,609,4168,3831,818,28187,234590,46420,25894,23551,18300,17947,14240,10399,8804,4790,3635,3283,3079,3014,2439,1436,66530,2435,329927,205211,182621,18480,15232,8066,39107,1329,7613,10972,24497,13528,13386,5629,1978,1386,25965,213996,152824,103480,72619,62052,53162,31195,28739,22060,19879,18909,18109,18035,15150,13773,13663,12296,4043,3607,685,143718,141951,48246,24650,20198,19735,14237,804,12740,10706,280709,115433,52824,48491,43647,30471,16601,10150,9916,9154,17125,33599,54814,34181,194673,170862,125074,71369,38761,12920,7416,6483,393735,60633,28213,21030,74440,58001,53552,21573,16250,14443,9628,9374,6652,30207,16977,10510,1488,38844,38279,37589,11204,43249,18953,8409,2854,2838,4626,1098],[110000,75000,73000,70000,65000,65000,62000,62000,60000,60000,60000,60000,60000,60000,58000,57100,57000,56000,54000,54000,53000,52000,52000,51000,50000,50000,50000,50000,50000,50000,50000,50000,50000,48000,47000,47000,46000,46000,46000,45000,45000,45000,45000,45000,45000,45000,45000,45000,44700,44000,42000,42000,41300,41000,41000,40100,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,39000,38400,38000,38000,38000,38000,38000,37500,37400,37000,36400,36200,36000,36000,36000,36000,36000,36000,35600,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,34000,34000,34000,34000,34000,34000,34000,34000,33500,33500,33400,33000,33000,33000,33000,33000,33000,33000,33000,33000,32500,32400,32200,32100,32000,32000,32000,32000,32000,32000,32000,32000,31500,31000,31000,31000,30500,30000,30000,30000,30000,30000,30000,30000,30000,29000,29000,29000,29000,28000,28000,28000,27500,27000,27000,26000,25000,25000,23400,22000]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Major<\/th>\n      <th>Major_category<\/th>\n      <th>Total<\/th>\n      <th>Median<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Major","targets":1},{"name":"Major_category","targets":2},{"name":"Total","targets":3},{"name":"Median","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s continue with more exploratory data analysis (EDA). Let’s plot median income by the total number of majors. Is there a correlation between the number of people majoring in a topic and that major’s median income? The <code>expand_limits</code> lets you put $0 on the Y-axis. You might try making the x-axis scale logarithmic.</p>
<div class="cell" data-hash="tidyeda_cache/html/scatter-income-total_ab760c6a83015b9bded72dcde1691ef8">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grads, <span class="fu">aes</span>(Total, Median)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scales<span class="sc">::</span><span class="fu">number_format</span>()) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Total number of majors"</span>, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Median income"</span>, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Median income as a function of major popularity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/scatter-income-total-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You could run a regression analysis to see if there’s a trend.</p>
<div class="cell" data-hash="tidyeda_cache/html/regress-income-total_91c184549db13ce0ec63ff3d9f75804e">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Median<span class="sc">~</span>(Total), <span class="at">data=</span>grads) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What categories of majors make more money than others? Let’s make a boxplot of median income by major category. Let’s expand the limits to include 0 on the y-axis, and flip the coordinate system.</p>
<div class="cell" data-hash="tidyeda_cache/html/income-by-major-boxplot_6730208a25f1174a1fecdfcd5529c81b">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Major_category, Median)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Major_category)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Major category"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Median income"</span>, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Median income by major category"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @drob"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/income-by-major-boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about unemployment rates? Let’s to the same thing here but before ggplot’ing, let’s mutate the major category to relevel it descending by the unemployment rate. Therefore the highest unemployment rate will be the first level of the factor. Let’s expand limits again, and flip the coordinate system.</p>
<div class="cell" data-hash="tidyeda_cache/html/unemployment-by-major-barplot_d8e10614b2b087477ba0a2d1b9382bcb">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major_category=</span><span class="fu">fct_reorder</span>(Major_category, <span class="sc">-</span>Unemployment_rate)) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Major_category, Unemployment_rate, <span class="at">fill =</span> Major_category)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Major category"</span>, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Unemployment rate"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Unemployment rate by major category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unemployment-by-major-barplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of these make sense except for the high median and large variability of “Computers &amp; Mathematics” category. Especially considering how these had the second highest median salary. Let’s see what these were. Perhaps it was the larger number of Computer and Information Systems, and Communication Technologies majors under this category that were dragging up the Unemployment rate.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-38_645201763103fe4ee6be99278b5c0f2d">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Major_category<span class="sc">==</span><span class="st">"Computers &amp; Mathematics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Major, Median, Sample_size, Unemployment_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 14
</div>
</div>
<div class="callout-body-container callout-body">
<p>What about “underemployment?” Which majors have more students finding jobs requiring college degrees? This time make a boxplot of each major category’s percentage of majors having jobs requiring a college degree (<code>pct_college</code>). Do the same factor reordering.</p>
<div class="cell" data-hash="tidyeda_cache/html/college-jobs_fe71d0e30b7a32d197c7b7f01c4f9b16">
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/college-jobs-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>What are the highest earning majors? First, filter to majors having at least 100 samples to use for income data. Try changing <code>head(20)</code> to <code>tail(20)</code> to get the lowest earners.</p>
<div class="cell" data-hash="tidyeda_cache/html/highest-earning-majors-dot-errorbars_a38f97e9ca5347d7955dcadbdb378a4e">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sample_size <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Major, Median, <span class="at">color =</span> Major_category)) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> P25th, <span class="at">ymax =</span> P75th)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"What are the highest-earning majors?"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Top 20 majors with at least 100 graduates surveyed.</span><span class="sc">\n</span><span class="st">Bars represent the 25th to 75th percentile."</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median salary of gradates"</span>, </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @drob"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/highest-earning-majors-dot-errorbars-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>How do the top majors break down by gender? This plot first gets the top 20 most popular majors by total overall students. It reorders the “Major” variable by the total number of people taking it. It then gathers the “Men” and “Women” variable into a column with the number of men or women, with a key column called “Gender” indicating whether you’re looking at men or women. It plots the total number in that major, and color-codes by gender.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-39_1b310b8d7d35c67c2acff8a5ef41436e">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total)) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major =</span> <span class="fu">fct_reorder</span>(Major, Total)) <span class="sc">|&gt;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(Gender, Number, Men, Women) <span class="sc">|&gt;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Major, Number, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span><span class="fu">number_format</span>()) <span class="sc">+</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">"Total number of majors"</span>, <span class="at">title=</span><span class="st">"Gender breakdown by top majors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What do earnings look like by gender? Let’s plot median salary by the Share of women in that major, making the size of the point proportional to the number of students enrolled in that major. Let’s also lump all the major categories together if they’re not one of the top four. I’m also passing the <code>label=</code> aesthetic mapping. You’ll see why in a few moments. For now, there is no geom that takes advantage of the label aesthetic.</p>
<div class="cell" data-hash="tidyeda_cache/html/earnings-by-gender_23ce77146505c04eb144e0c6042992b7">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> grads <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major_category =</span> <span class="fu">fct_lump</span>(Major_category, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ShareWomen, Median, <span class="at">label=</span>Major)) <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Total, <span class="at">color=</span>Major_category)) <span class="sc">+</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">labels=</span><span class="fu">number_format</span>()) <span class="sc">+</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span><span class="fu">percent_format</span>()) <span class="sc">+</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Proportion of women with major"</span>, </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Median income by the proportion of women in each major"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/earnings-by-gender-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If you have the <strong>plotly</strong> package installed, you can make an interactive graphic. Try hovering over the points, or using your mouse to click+drag a box around a segment of the plot to zoom in on.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-40_b004278697361988092342e4f14e60a5">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ce2e119cea85b217f913" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ce2e119cea85b217f913">{"x":{"data":[{"x":[0.42968496299999998,0.71985895200000005,0.448732309,0.73396758299999998,0.65212981699999995,0.73399192800000002,0.41680957400000002,0.70089842999999996,0.68699295199999999,0.84593437900000001,0.69738424499999996,0.38371900599999997,0.70713623699999995,0.69011067500000001,0.62950456399999999],"y":[40000,35000,34000,34000,34000,33000,32200,32000,32000,31000,30000,29000,28000,27500,27000],"text":["ShareWomen: 0.42968496<br />Median:  40000<br />Major: United States History<br />Total:   3079<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.71985895<br />Median:  35000<br />Major: Area Ethnic And Civilization Studies<br />Total:  31195<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.44873231<br />Median:  34000<br />Major: History<br />Total: 141951<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.73396758<br />Median:  34000<br />Major: French German Latin And Other Common Foreign Language Studies<br />Total:  48246<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.65212982<br />Median:  34000<br />Major: Intercultural And International Studies<br />Total:  24650<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.73399193<br />Median:  33000<br />Major: Linguistics And Comparative Language And Literature<br />Total:  16601<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.41680957<br />Median:  32200<br />Major: Philosophy And Religious Studies<br />Total:  54814<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.70089843<br />Median:  32000<br />Major: English Language And Literature<br />Total: 194673<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.68699295<br />Median:  32000<br />Major: Liberal Arts<br />Total:  71369<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.84593438<br />Median:  31000<br />Major: Art History And Criticism<br />Total:  21030<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.69738424<br />Median:  30000<br />Major: Humanities<br />Total:   6652<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.38371901<br />Median:  29000<br />Major: Theology And Religious Vocations<br />Total:  30207<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.70713624<br />Median:  28000<br />Major: Anthropology And Archeology<br />Total:  38844<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.69011068<br />Median:  27500<br />Major: Other Foreign Languages<br />Total:  11204<br />Major_category: Humanities & Liberal Arts","ShareWomen: 0.62950456<br />Median:  27000<br />Major: Composition And Rhetoric<br />Total:  18953<br />Major_category: Humanities & Liberal Arts"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":[5.2774527126307653,9.0506484791930379,15.110762732009222,10.357830033176496,8.4527655780310571,7.591002138129002,10.796686464875835,17.056960796772486,11.796964432332681,8.0865798023628717,6.1225040669795199,8.9648148074560954,9.6730125828374014,6.8818870253641,7.8616747287549948],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Humanities & Liberal Arts","legendgroup":"Humanities & Liberal Arts","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.85452322700000005,0.90667733699999997,0.812876606,0.50737696799999998,0.72803259099999995,0.65174129400000003,0.87722752800000003,0.64000000000000001,0.60175182500000002,0.68602439999999998,0.92374547900000004,0.68394261899999997,0.44458228500000002,0.81070414700000004,0.96895368299999995,0.87795992700000003],"y":[41000,35000,34000,34000,34000,34000,33000,33000,32500,32100,32000,32000,31000,30000,28000,22000],"text":["ShareWomen: 0.85452323<br />Median:  41000<br />Major: School Student Counseling<br />Total:    818<br />Major_category: Education","ShareWomen: 0.90667734<br />Median:  35000<br />Major: Special Needs Education<br />Total:  28739<br />Major_category: Education","ShareWomen: 0.81287661<br />Median:  34000<br />Major: General Education<br />Total: 143718<br />Major_category: Education","ShareWomen: 0.50737697<br />Median:  34000<br />Major: Social Science Or History Teacher Education<br />Total:  20198<br />Major_category: Education","ShareWomen: 0.72803259<br />Median:  34000<br />Major: Mathematics Teacher Education<br />Total:  14237<br />Major_category: Education","ShareWomen: 0.65174129<br />Median:  34000<br />Major: Educational Administration And Supervision<br />Total:    804<br />Major_category: Education","ShareWomen: 0.87722753<br />Median:  33000<br />Major: Language And Drama Education<br />Total:  30471<br />Major_category: Education","ShareWomen: 0.64000000<br />Median:  33000<br />Major: Miscellaneous Education<br />Total:  10150<br />Major_category: Education","ShareWomen: 0.60175183<br />Median:  32500<br />Major: Secondary Teacher Education<br />Total:  17125<br />Major_category: Education","ShareWomen: 0.68602440<br />Median:  32100<br />Major: Art And Music Education<br />Total:  34181<br />Major_category: Education","ShareWomen: 0.92374548<br />Median:  32000<br />Major: Elementary Education<br />Total: 170862<br />Major_category: Education","ShareWomen: 0.68394262<br />Median:  32000<br />Major: Science And Computer Teacher Education<br />Total:   6483<br />Major_category: Education","ShareWomen: 0.44458229<br />Median:  31000<br />Major: Physical And Health Education Teaching<br />Total:  28213<br />Major_category: Education","ShareWomen: 0.81070415<br />Median:  30000<br />Major: Teacher Education: Multiple Levels<br />Total:  14443<br />Major_category: Education","ShareWomen: 0.96895368<br />Median:  28000<br />Major: Early Childhood Education<br />Total:  37589<br />Major_category: Education","ShareWomen: 0.87795993<br />Median:  22000<br />Major: Library Science<br />Total:   1098<br />Major_category: Education"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":[4.2152548681237159,8.8345897514568676,15.181371974301967,7.9979276736189506,7.2980287263757742,4.2004081927502028,8.9878886106366682,6.7235328415080273,7.652942951946482,9.3019578715630704,16.21576552549741,6.0895096246222939,8.7871046782183395,7.3245217076713232,9.5754836998032928,4.4460212865873885],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Education","legendgroup":"Education","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.70771850199999997,0.56486557000000004,0.59420764999999998,0.51554332899999999,0.58094800400000002,0.51540644899999999,0.52896915,0.58455613299999998,0.61822302799999995,0.63814682,0.55660377400000005,0.60185815200000004,0.57636006100000003,0.63729337600000002],"y":[45000,41000,40000,40000,38000,37400,37000,35600,35000,35000,33500,33400,33000,26000],"text":["ShareWomen: 0.70771850<br />Median:  45000<br />Major: Pharmacology<br />Total:   1762<br />Major_category: Biology & Life Science","ShareWomen: 0.56486557<br />Median:  41000<br />Major: Cognitive Science And Biopsychology<br />Total:   3831<br />Major_category: Biology & Life Science","ShareWomen: 0.59420765<br />Median:  40000<br />Major: Molecular Biology<br />Total:  18300<br />Major_category: Biology & Life Science","ShareWomen: 0.51554333<br />Median:  40000<br />Major: Genetics<br />Total:   3635<br />Major_category: Biology & Life Science","ShareWomen: 0.58094800<br />Median:  38000<br />Major: Microbiology<br />Total:  15232<br />Major_category: Biology & Life Science","ShareWomen: 0.51540645<br />Median:  37400<br />Major: Biochemical Sciences<br />Total:  39107<br />Major_category: Biology & Life Science","ShareWomen: 0.52896915<br />Median:  37000<br />Major: Botany<br />Total:   1329<br />Major_category: Biology & Life Science","ShareWomen: 0.58455613<br />Median:  35600<br />Major: Environmental Science<br />Total:  25965<br />Major_category: Biology & Life Science","ShareWomen: 0.61822303<br />Median:  35000<br />Major: Physiology<br />Total:  22060<br />Major_category: Biology & Life Science","ShareWomen: 0.63814682<br />Median:  35000<br />Major: Neuroscience<br />Total:  13663<br />Major_category: Biology & Life Science","ShareWomen: 0.55660377<br />Median:  33500<br />Major: Miscellaneous Biology<br />Total:  10706<br />Major_category: Biology & Life Science","ShareWomen: 0.60185815<br />Median:  33400<br />Major: Biology<br />Total: 280709<br />Major_category: Biology & Life Science","ShareWomen: 0.57636006<br />Median:  33000<br />Major: Ecology<br />Total:   9154<br />Major_category: Biology & Life Science","ShareWomen: 0.63729338<br />Median:  26000<br />Major: Zoology<br />Total:   8409<br />Major_category: Biology & Life Science"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":[4.8029531930349547,5.4903478993877197,7.7883592987404189,5.437495386310994,7.4242115317401245,9.6932470576352916,4.5882656252060263,8.578872982517419,8.1938637801662768,7.2231334427829346,6.8080989472861395,19.730904999820538,6.5656337835088578,6.4414104101180705],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"Biology & Life Science","legendgroup":"Biology & Life Science","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.120564344,0.10185185200000001,0.153037383,0.107313196,0.341630502,0.144966965,0.11955890299999999,0.19645025599999999,0.199412643,0.13979280099999999,0.437846874,0.31082028499999997,0.18398518899999999,0.32078431400000001,0.34347321800000002,0.25295983799999999,0.350442478,0.292607004,0.32509188100000003,0.22711794299999999,0.18997043699999999,0.34222881100000002,0.251388889,0.322222222,0.24919024000000001,0.17412250500000001,0.45146488600000001,0.20002271699999999,0.077453026999999994],"y":[110000,75000,73000,70000,65000,65000,60000,60000,60000,60000,60000,60000,58000,57100,57000,56000,54000,52000,52000,50000,50000,50000,50000,50000,46000,44000,40000,40000,40000],"text":["ShareWomen: 0.12056434<br />Median: 110000<br />Major: Petroleum Engineering<br />Total:   2339<br />Major_category: Engineering","ShareWomen: 0.10185185<br />Median:  75000<br />Major: Mining And Mineral Engineering<br />Total:    756<br />Major_category: Engineering","ShareWomen: 0.15303738<br />Median:  73000<br />Major: Metallurgical Engineering<br />Total:    856<br />Major_category: Engineering","ShareWomen: 0.10731320<br />Median:  70000<br />Major: Naval Architecture And Marine Engineering<br />Total:   1258<br />Major_category: Engineering","ShareWomen: 0.34163050<br />Median:  65000<br />Major: Chemical Engineering<br />Total:  32260<br />Major_category: Engineering","ShareWomen: 0.14496697<br />Median:  65000<br />Major: Nuclear Engineering<br />Total:   2573<br />Major_category: Engineering","ShareWomen: 0.11955890<br />Median:  60000<br />Major: Mechanical Engineering<br />Total:  91227<br />Major_category: Engineering","ShareWomen: 0.19645026<br />Median:  60000<br />Major: Electrical Engineering<br />Total:  81527<br />Major_category: Engineering","ShareWomen: 0.19941264<br />Median:  60000<br />Major: Computer Engineering<br />Total:  41542<br />Major_category: Engineering","ShareWomen: 0.13979280<br />Median:  60000<br />Major: Aerospace Engineering<br />Total:  15058<br />Major_category: Engineering","ShareWomen: 0.43784687<br />Median:  60000<br />Major: Biomedical Engineering<br />Total:  14955<br />Major_category: Engineering","ShareWomen: 0.31082028<br />Median:  60000<br />Major: Materials Science<br />Total:   4279<br />Major_category: Engineering","ShareWomen: 0.18398519<br />Median:  58000<br />Major: Engineering Mechanics Physics And Science<br />Total:   4321<br />Major_category: Engineering","ShareWomen: 0.32078431<br />Median:  57100<br />Major: Biological Engineering<br />Total:   8925<br />Major_category: Engineering","ShareWomen: 0.34347322<br />Median:  57000<br />Major: Industrial And Manufacturing Engineering<br />Total:  18968<br />Major_category: Engineering","ShareWomen: 0.25295984<br />Median:  56000<br />Major: General Engineering<br />Total:  61152<br />Major_category: Engineering","ShareWomen: 0.35044248<br />Median:  54000<br />Major: Architectural Engineering<br />Total:   2825<br />Major_category: Engineering","ShareWomen: 0.29260700<br />Median:  52000<br />Major: Electrical Engineering Technology<br />Total:  11565<br />Major_category: Engineering","ShareWomen: 0.32509188<br />Median:  52000<br />Major: Materials Engineering And Materials Science<br />Total:   2993<br />Major_category: Engineering","ShareWomen: 0.22711794<br />Median:  50000<br />Major: Civil Engineering<br />Total:  53153<br />Major_category: Engineering","ShareWomen: 0.18997044<br />Median:  50000<br />Major: Miscellaneous Engineering<br />Total:   9133<br />Major_category: Engineering","ShareWomen: 0.34222881<br />Median:  50000<br />Major: Environmental Engineering<br />Total:   4047<br />Major_category: Engineering","ShareWomen: 0.25138889<br />Median:  50000<br />Major: Engineering Technologies<br />Total:   3600<br />Major_category: Engineering","ShareWomen: 0.32222222<br />Median:  50000<br />Major: Geological And Geophysical Engineering<br />Total:    720<br />Major_category: Engineering","ShareWomen: 0.24919024<br />Median:  46000<br />Major: Industrial Production Technologies<br />Total:   4631<br />Major_category: Engineering","ShareWomen: 0.17412251<br />Median:  44000<br />Major: Engineering And Industrial Management<br />Total:   2906<br />Major_category: Engineering","ShareWomen: 0.45146489<br />Median:  40000<br />Major: Architecture<br />Total:  46420<br />Major_category: Engineering","ShareWomen: 0.20002272<br />Median:  40000<br />Major: Miscellaneous Engineering Technologies<br />Total:   8804<br />Major_category: Engineering","ShareWomen: 0.07745303<br />Median:  40000<br />Major: Mechanical Engineering Related Technologies<br />Total:   4790<br />Major_category: Engineering"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":[5.033144027063118,4.1449542829138712,4.253213084030774,4.5473556300045805,9.1416330644763502,5.1152381782553782,12.852484993268495,12.353147089632602,9.8774012559662392,7.4024624774603964,7.389526298439538,5.6054178072492631,5.6158359586972466,6.5280474059653519,7.8633433859500963,11.195593889671743,5.1983449888602609,6.934297170433787,5.2511444452391185,10.688336815943057,6.562208141491233,5.5467636538619818,5.4278791192794866,4.0970709852633558,5.690976361766384,5.2240428205973917,10.230519851528557,6.5079782902806702,5.7283924005009865],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Engineering","legendgroup":"Engineering","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.441355573,0.53571428600000004,0.236062718,0.222695002,0.27879014600000002,0.090712508999999997,0.32483804999999999,0.55854800900000001,0.41017964099999998,0.89601898800000002,0.34082495699999998,0.35546905899999998,0.43053676099999999,0.75047258999999999,0.52415258300000001,0.44809867799999997,0.25358330200000001,0.281936407,0.75392736000000005,0.244103081,0.52647576399999996,0.43429844099999998,0.68899917300000002,0.92780724599999997,0.17898193800000001,0.26919385800000001,0.632986838,0.43630163300000002,0.58971190200000001,0.63071631800000005,0.42692372000000001,0.32176966299999998,0.41792479999999999,0.54340542199999997,0.64333112100000001,0.28290282900000002,0.37743732600000002,0.50514053800000003,0.23244353200000001,0.47318952399999997,0.61572722700000004,0.48592987700000001,0.38290043299999998,0.180882718,0.30500459699999999,0.47019686500000002,0.74756092600000001,0.67216144300000003,0.88129388900000005,0.47646118300000001,0.59100101100000002,0.70202020200000004,0.66999850500000002,0.47501047000000002,0.69036528799999997,0.67314339199999995,0.56463933499999996,0.75806026900000001,0.49539715299999998,0.86445607899999999,0.76442652799999999,0.36617687799999998,0.12495049499999999,0.37435562300000003,0.77090110599999995,0.32129606700000002,0.12503465499999999,0.30510948900000001,0.79209526200000002,0.56664050200000005,0.71836476599999999,0.53233378799999997,0.72186591300000003,0.65165990799999995,0.76432029000000001,0.77457662400000005,0.50284631499999999,0.423208896,0.606888545,0.33967098200000001,0.77993320399999999,0.50672076300000002,0.66703385299999995,0.91093257000000005,0.90407454399999998,0.75214388399999998,0.74566153800000001,0.79891981700000003,0.90558992999999999,0.71997408299999999,0.584776403,0.72849462399999998,0.96799811899999999,0.666119448,0.81709880899999998,0.79985905599999996,0.79874621700000004],"y":[62000,62000,54000,53000,51000,50000,50000,50000,50000,48000,47000,47000,46000,46000,45000,45000,45000,45000,45000,45000,45000,45000,44700,42000,42000,41300,40100,40000,40000,40000,40000,40000,40000,40000,40000,40000,40000,39000,38400,38000,38000,38000,38000,37500,36400,36200,36000,36000,36000,36000,36000,36000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,35000,34000,33500,33000,33000,33000,33000,33000,32400,32000,32000,32000,32000,31500,31000,30500,30000,30000,30000,30000,30000,30000,29000,29000,29000,28000,27000,25000,25000,23400],"text":["ShareWomen: 0.44135557<br />Median:  62000<br />Major: Actuarial Science<br />Total:   3777<br />Major_category: Other","ShareWomen: 0.53571429<br />Median:  62000<br />Major: Astronomy And Astrophysics<br />Total:   1792<br />Major_category: Other","ShareWomen: 0.23606272<br />Median:  54000<br />Major: Court Reporting<br />Total:   1148<br />Major_category: Other","ShareWomen: 0.22269500<br />Median:  53000<br />Major: Computer Science<br />Total: 128319<br />Major_category: Other","ShareWomen: 0.27879015<br />Median:  51000<br />Major: Management Information Systems And Statistics<br />Total:  18713<br />Major_category: Other","ShareWomen: 0.09071251<br />Median:  50000<br />Major: Construction Services<br />Total:  18498<br />Major_category: Other","ShareWomen: 0.32483805<br />Median:  50000<br />Major: Operations Logistics And E-Commerce<br />Total:  11732<br />Major_category: Other","ShareWomen: 0.55854801<br />Median:  50000<br />Major: Public Policy<br />Total:   5978<br />Major_category: Other","ShareWomen: 0.41017964<br />Median:  50000<br />Major: Miscellaneous Fine Arts<br />Total:   3340<br />Major_category: Other","ShareWomen: 0.89601899<br />Median:  48000<br />Major: Nursing<br />Total: 209394<br />Major_category: Other","ShareWomen: 0.34082496<br />Median:  47000<br />Major: Finance<br />Total: 174506<br />Major_category: Other","ShareWomen: 0.35546906<br />Median:  47000<br />Major: Economics<br />Total: 139247<br />Major_category: Other","ShareWomen: 0.43053676<br />Median:  46000<br />Major: Business Economics<br />Total:  13302<br />Major_category: Other","ShareWomen: 0.75047259<br />Median:  46000<br />Major: Nuclear, Industrial Radiology, And Biological Technologies<br />Total:   2116<br />Major_category: Other","ShareWomen: 0.52415258<br />Median:  45000<br />Major: Accounting<br />Total: 198633<br />Major_category: Other","ShareWomen: 0.44809868<br />Median:  45000<br />Major: Mathematics<br />Total:  72397<br />Major_category: Other","ShareWomen: 0.25358330<br />Median:  45000<br />Major: Computer And Information Systems<br />Total:  36698<br />Major_category: Other","ShareWomen: 0.28193641<br />Median:  45000<br />Major: Physics<br />Total:  32142<br />Major_category: Other","ShareWomen: 0.75392736<br />Median:  45000<br />Major: Medical Technologies Technicians<br />Total:  15914<br />Major_category: Other","ShareWomen: 0.24410308<br />Median:  45000<br />Major: Information Sciences<br />Total:  11913<br />Major_category: Other","ShareWomen: 0.52647576<br />Median:  45000<br />Major: Statistics And Decision Science<br />Total:   6251<br />Major_category: Other","ShareWomen: 0.43429844<br />Median:  45000<br />Major: Applied Mathematics<br />Total:   4939<br />Major_category: Other","ShareWomen: 0.68899917<br />Median:  44700<br />Major: Oceanography<br />Total:   2418<br />Major_category: Other","ShareWomen: 0.92780725<br />Median:  42000<br />Major: Medical Assisting Services<br />Total:  11123<br />Major_category: Other","ShareWomen: 0.17898194<br />Median:  42000<br />Major: Mathematics And Computer Science<br />Total:    609<br />Major_category: Other","ShareWomen: 0.26919386<br />Median:  41300<br />Major: Computer Programming And Data Processing<br />Total:   4168<br />Major_category: Other","ShareWomen: 0.63298684<br />Median:  40100<br />Major: International Relations<br />Total:  28187<br />Major_category: Other","ShareWomen: 0.43630163<br />Median:  40000<br />Major: General Business<br />Total: 234590<br />Major_category: Other","ShareWomen: 0.58971190<br />Median:  40000<br />Major: International Business<br />Total:  25894<br />Major_category: Other","ShareWomen: 0.63071632<br />Median:  40000<br />Major: Pharmacy Pharmaceutical Sciences And Administration<br />Total:  23551<br />Major_category: Other","ShareWomen: 0.42692372<br />Median:  40000<br />Major: Miscellaneous Business & Medical Administration<br />Total:  17947<br />Major_category: Other","ShareWomen: 0.32176966<br />Median:  40000<br />Major: Agriculture Production And Management<br />Total:  14240<br />Major_category: Other","ShareWomen: 0.41792480<br />Median:  40000<br />Major: General Agriculture<br />Total:  10399<br />Major_category: Other","ShareWomen: 0.54340542<br />Median:  40000<br />Major: Miscellaneous Social Sciences<br />Total:   3283<br />Major_category: Other","ShareWomen: 0.64333112<br />Median:  40000<br />Major: Industrial And Organizational Psychology<br />Total:   3014<br />Major_category: Other","ShareWomen: 0.28290283<br />Median:  40000<br />Major: Agricultural Economics<br />Total:   2439<br />Major_category: Other","ShareWomen: 0.37743733<br />Median:  40000<br />Major: Physical Sciences<br />Total:   1436<br />Major_category: Other","ShareWomen: 0.50514054<br />Median:  39000<br />Major: Chemistry<br />Total:  66530<br />Major_category: Other","ShareWomen: 0.23244353<br />Median:  38400<br />Major: Electrical, Mechanical, And Precision Technologies And Production<br />Total:   2435<br />Major_category: Other","ShareWomen: 0.47318952<br />Median:  38000<br />Major: Business Management And Administration<br />Total: 329927<br />Major_category: Other","ShareWomen: 0.61572723<br />Median:  38000<br />Major: Marketing And Marketing Research<br />Total: 205211<br />Major_category: Other","ShareWomen: 0.48592988<br />Median:  38000<br />Major: Political Science And Government<br />Total: 182621<br />Major_category: Other","ShareWomen: 0.38290043<br />Median:  38000<br />Major: Geography<br />Total:  18480<br />Major_category: Other","ShareWomen: 0.18088272<br />Median:  37500<br />Major: Computer Administration Management And Security<br />Total:   8066<br />Major_category: Other","ShareWomen: 0.30500460<br />Median:  36400<br />Major: Computer Networking And Telecommunications<br />Total:   7613<br />Major_category: Other","ShareWomen: 0.47019687<br />Median:  36200<br />Major: Geology And Earth Science<br />Total:  10972<br />Major_category: Other","ShareWomen: 0.74756093<br />Median:  36000<br />Major: Human Resources And Personnel Management<br />Total:  24497<br />Major_category: Other","ShareWomen: 0.67216144<br />Median:  36000<br />Major: Pre-Law And Legal Studies<br />Total:  13528<br />Major_category: Other","ShareWomen: 0.88129389<br />Median:  36000<br />Major: Miscellaneous Health Medical Professions<br />Total:  13386<br />Major_category: Other","ShareWomen: 0.47646118<br />Median:  36000<br />Major: Public Administration<br />Total:   5629<br />Major_category: Other","ShareWomen: 0.59100101<br />Median:  36000<br />Major: Geosciences<br />Total:   1978<br />Major_category: Other","ShareWomen: 0.70202020<br />Median:  36000<br />Major: Social Psychology<br />Total:   1386<br />Major_category: Other","ShareWomen: 0.66999851<br />Median:  35000<br />Major: Communications<br />Total: 213996<br />Major_category: Other","ShareWomen: 0.47501047<br />Median:  35000<br />Major: Criminal Justice And Fire Protection<br />Total: 152824<br />Major_category: Other","ShareWomen: 0.69036529<br />Median:  35000<br />Major: Commercial Art And Graphic Design<br />Total: 103480<br />Major_category: Other","ShareWomen: 0.67314339<br />Median:  35000<br />Major: Journalism<br />Total:  72619<br />Major_category: Other","ShareWomen: 0.56463933<br />Median:  35000<br />Major: Multi-Disciplinary Or General Science<br />Total:  62052<br />Major_category: Other","ShareWomen: 0.75806027<br />Median:  35000<br />Major: Advertising And Public Relations<br />Total:  53162<br />Major_category: Other","ShareWomen: 0.49539715<br />Median:  35000<br />Major: Criminology<br />Total:  19879<br />Major_category: Other","ShareWomen: 0.86445608<br />Median:  35000<br />Major: Nutrition Sciences<br />Total:  18909<br />Major_category: Other","ShareWomen: 0.76442653<br />Median:  35000<br />Major: Health And Medical Administrative Services<br />Total:  18109<br />Major_category: Other","ShareWomen: 0.36617688<br />Median:  35000<br />Major: Communication Technologies<br />Total:  18035<br />Major_category: Other","ShareWomen: 0.12495049<br />Median:  35000<br />Major: Transportation Sciences And Technologies<br />Total:  15150<br />Major_category: Other","ShareWomen: 0.37435562<br />Median:  35000<br />Major: Natural Resources Management<br />Total:  13773<br />Major_category: Other","ShareWomen: 0.77090111<br />Median:  35000<br />Major: Multi/Interdisciplinary Studies<br />Total:  12296<br />Major_category: Other","ShareWomen: 0.32129607<br />Median:  35000<br />Major: Atmospheric Sciences And Meteorology<br />Total:   4043<br />Major_category: Other","ShareWomen: 0.12503465<br />Median:  35000<br />Major: Forestry<br />Total:   3607<br />Major_category: Other","ShareWomen: 0.30510949<br />Median:  35000<br />Major: Soil Science<br />Total:    685<br />Major_category: Other","ShareWomen: 0.79209526<br />Median:  34000<br />Major: Community And Public Health<br />Total:  19735<br />Major_category: Other","ShareWomen: 0.56664050<br />Median:  33500<br />Major: Health And Medical Preparatory Programs<br />Total:  12740<br />Major_category: Other","ShareWomen: 0.71836477<br />Median:  33000<br />Major: Sociology<br />Total: 115433<br />Major_category: Other","ShareWomen: 0.53233379<br />Median:  33000<br />Major: Mass Media<br />Total:  52824<br />Major_category: Other","ShareWomen: 0.72186591<br />Median:  33000<br />Major: Treatment Therapy Professions<br />Total:  48491<br />Major_category: Other","ShareWomen: 0.65165991<br />Median:  33000<br />Major: Hospitality Management<br />Total:  43647<br />Major_category: Other","ShareWomen: 0.76432029<br />Median:  33000<br />Major: Interdisciplinary Social Sciences<br />Total:   9916<br />Major_category: Other","ShareWomen: 0.77457662<br />Median:  32400<br />Major: General Medical And Health Services<br />Total:  33599<br />Major_category: Other","ShareWomen: 0.50284631<br />Median:  32000<br />Major: Physical Fitness Parks Recreation And Leisure<br />Total: 125074<br />Major_category: Other","ShareWomen: 0.42320890<br />Median:  32000<br />Major: Film Video And Photographic Arts<br />Total:  38761<br />Major_category: Other","ShareWomen: 0.60688855<br />Median:  32000<br />Major: General Social Sciences<br />Total:  12920<br />Major_category: Other","ShareWomen: 0.33967098<br />Median:  32000<br />Major: Plant Science And Agronomy<br />Total:   7416<br />Major_category: Other","ShareWomen: 0.77993320<br />Median:  31500<br />Major: Psychology<br />Total: 393735<br />Major_category: Other","ShareWomen: 0.50672076<br />Median:  31000<br />Major: Music<br />Total:  60633<br />Major_category: Other","ShareWomen: 0.66703385<br />Median:  30500<br />Major: Fine Arts<br />Total:  74440<br />Major_category: Other","ShareWomen: 0.91093257<br />Median:  30000<br />Major: Family And Consumer Sciences<br />Total:  58001<br />Major_category: Other","ShareWomen: 0.90407454<br />Median:  30000<br />Major: Social Work<br />Total:  53552<br />Major_category: Other","ShareWomen: 0.75214388<br />Median:  30000<br />Major: Animal Sciences<br />Total:  21573<br />Major_category: Other","ShareWomen: 0.74566154<br />Median:  30000<br />Major: Visual And Performing Arts<br />Total:  16250<br />Major_category: Other","ShareWomen: 0.79891982<br />Median:  30000<br />Major: Miscellaneous Psychology<br />Total:   9628<br />Major_category: Other","ShareWomen: 0.90558993<br />Median:  30000<br />Major: Human Services And Community Organization<br />Total:   9374<br />Major_category: Other","ShareWomen: 0.71997408<br />Median:  29000<br />Major: Studio Arts<br />Total:  16977<br />Major_category: Other","ShareWomen: 0.58477640<br />Median:  29000<br />Major: Cosmetology Services And Culinary Arts<br />Total:  10510<br />Major_category: Other","ShareWomen: 0.72849462<br />Median:  29000<br />Major: Miscellaneous Agriculture<br />Total:   1488<br />Major_category: Other","ShareWomen: 0.96799812<br />Median:  28000<br />Major: Communication Disorders Sciences And Services<br />Total:  38279<br />Major_category: Other","ShareWomen: 0.66611945<br />Median:  27000<br />Major: Drama And Theater Arts<br />Total:  43249<br />Major_category: Other","ShareWomen: 0.81709881<br />Median:  25000<br />Major: Educational Psychology<br />Total:   2854<br />Major_category: Other","ShareWomen: 0.79985906<br />Median:  25000<br />Major: Clinical Psychology<br />Total:   2838<br />Major_category: Other","ShareWomen: 0.79874622<br />Median:  23400<br />Major: Counseling Psychology<br />Total:   4626<br />Major_category: Other"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":[5.4759508383172983,4.8161819923671194,4.4792664616970388,14.550479533180384,7.8348828367763614,7.8107305635575832,6.9582499830174127,5.9879814636300637,5.3546070879471275,17.551345852335384,16.348150046108156,15.001850944597619,7.1751842613387087,4.9495609692379663,17.191743942265994,11.854993021658563,9.5052337798343611,9.1316283366672444,7.5082349532716677,6.9840086366044485,6.0434324509575426,5.7628146503394824,5.0614475506494827,6.8700053241405241,3.7795275590551185,5.5775935675549206,8.7847458230263378,18.358668464442491,8.5721488856993364,8.3447009235822804,7.748162359249239,7.2984159777206852,6.7617015823816109,5.3380832973204271,5.2576117683526684,5.06886674442186,4.6462786396584965,11.517969533023997,5.0674568597078054,21.075674714749095,17.412688898494469,16.638067195651939,7.8087019449583481,6.3822251407177868,6.3019319032741246,6.8477326490930537,8.4378713005933434,7.2052808698266411,7.1864016571184699,5.9149976619313707,4.8947034223966286,4.6196684952655049,17.702296503761158,15.538526818271002,13.44644740894223,11.86746982472178,11.250512192599578,10.688928478368311,7.9634391049672146,7.8567760613200637,7.7666599948705075,7.7582211271809403,7.413978192393901,7.2376118404329297,7.0378432438816487,5.5457352941037898,5.4298068554526697,4.0422810127081652,7.9477771163739019,7.0991595284304649,13.992636699128532,10.66667337694795,10.374724644198343,10.032228790928531,6.6872067871900134,9.2538805136635247,14.412758803424023,9.6666123603905927,7.1236972208709206,6.2662053311426318,22.677165354330711,11.163738657435722,11.969095918372592,11.000028296283341,10.714518696716732,8.1434669731505185,7.5489420431429606,6.6418649937176593,6.6012714743094376,7.6355490453174824,6.7785600251900524,4.6731129799741327,9.6293063975497493,10.003250269503203,5.2075985909287628,5.202500596855498,5.689787871442741],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Other","legendgroup":"Other","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.077453026999999994,0.088737845430379741,0.10002266386075949,0.11130748229113924,0.12259230072151897,0.13387711915189873,0.14516193758227847,0.15644675601265823,0.16773157444303796,0.1790163928734177,0.19030121130379746,0.20158602973417722,0.21287084816455693,0.22415566659493669,0.23544048502531645,0.24672530345569621,0.25801012188607592,0.26929494031645568,0.28057975874683544,0.29186457717721515,0.30314939560759491,0.31443421403797467,0.32571903246835443,0.33700385089873419,0.3482886693291139,0.35957348775949366,0.37085830618987342,0.38214312462025313,0.39342794305063289,0.40471276148101265,0.41599757991139241,0.42728239834177212,0.43856721677215188,0.44985203520253164,0.46113685363291135,0.47242167206329111,0.48370649049367087,0.49499130892405063,0.50627612735443028,0.51756094578481004,0.52884576421518981,0.54013058264556957,0.55141540107594933,0.56270021950632909,0.57398503793670885,0.58526985636708861,0.59655467479746838,0.60783949322784803,0.61912431165822779,0.63040913008860755,0.64169394851898731,0.65297876694936707,0.66426358537974683,0.6755484038101266,0.68683322224050625,0.69811804067088601,0.70940285910126577,0.72068767753164553,0.73197249596202529,0.74325731439240506,0.75454213282278482,0.76582695125316447,0.77711176968354423,0.78839658811392399,0.79968140654430375,0.81096622497468351,0.82225104340506328,0.83353586183544304,0.84482068026582269,0.85610549869620245,0.86739031712658221,0.87867513555696197,0.88995995398734173,0.9012447724177215,0.91252959084810126,0.92381440927848091,0.93509922770886067,0.94638404613924043,0.95766886456962019,0.96895368299999995],"y":[54238.894335138371,53882.030634176881,53525.166933215391,53168.3032322539,52811.439531292417,52454.575830330927,52097.712129369436,51740.848428407946,51383.984727446456,51027.121026484965,50670.257325523475,50313.393624561992,49956.529923600501,49599.666222639011,49242.80252167752,48885.93882071603,48529.07511975454,48172.211418793049,47815.347717831559,47458.484016870076,47101.620315908585,46744.756614947095,46387.892913985605,46031.029213024114,45674.165512062624,45317.301811101133,44960.43811013965,44603.57440917816,44246.710708216669,43889.847007255179,43532.983306293689,43176.119605332198,42819.255904370708,42462.392203409217,42105.528502447734,41748.664801486244,41391.801100524754,41034.937399563263,40678.07369860178,40321.20999764029,39964.346296678799,39607.482595717309,39250.618894755818,38893.755193794328,38536.891492832838,38180.027791871347,37823.164090909857,37466.300389948374,37109.436688986883,36752.572988025393,36395.709287063903,36038.845586102412,35681.981885140922,35325.118184179431,34968.254483217948,34611.390782256458,34254.527081294968,33897.663380333477,33540.799679371987,33183.935978410496,32827.072277449006,32470.208576487519,32113.344875526029,31756.481174564538,31399.617473603052,31042.753772641561,30685.890071680071,30329.02637071858,29972.162669757094,29615.298968795603,29258.435267834113,28901.571566872626,28544.707865911136,28187.844164949645,27830.980463988155,27474.116763026668,27117.253062065178,26760.389361103687,26403.525660142197,26046.66195918071],"text":["ShareWomen: 0.07745303<br />Median: 54238.89","ShareWomen: 0.08873785<br />Median: 53882.03","ShareWomen: 0.10002266<br />Median: 53525.17","ShareWomen: 0.11130748<br />Median: 53168.30","ShareWomen: 0.12259230<br />Median: 52811.44","ShareWomen: 0.13387712<br />Median: 52454.58","ShareWomen: 0.14516194<br />Median: 52097.71","ShareWomen: 0.15644676<br />Median: 51740.85","ShareWomen: 0.16773157<br />Median: 51383.98","ShareWomen: 0.17901639<br />Median: 51027.12","ShareWomen: 0.19030121<br />Median: 50670.26","ShareWomen: 0.20158603<br />Median: 50313.39","ShareWomen: 0.21287085<br />Median: 49956.53","ShareWomen: 0.22415567<br />Median: 49599.67","ShareWomen: 0.23544049<br />Median: 49242.80","ShareWomen: 0.24672530<br />Median: 48885.94","ShareWomen: 0.25801012<br />Median: 48529.08","ShareWomen: 0.26929494<br />Median: 48172.21","ShareWomen: 0.28057976<br />Median: 47815.35","ShareWomen: 0.29186458<br />Median: 47458.48","ShareWomen: 0.30314940<br />Median: 47101.62","ShareWomen: 0.31443421<br />Median: 46744.76","ShareWomen: 0.32571903<br />Median: 46387.89","ShareWomen: 0.33700385<br />Median: 46031.03","ShareWomen: 0.34828867<br />Median: 45674.17","ShareWomen: 0.35957349<br />Median: 45317.30","ShareWomen: 0.37085831<br />Median: 44960.44","ShareWomen: 0.38214312<br />Median: 44603.57","ShareWomen: 0.39342794<br />Median: 44246.71","ShareWomen: 0.40471276<br />Median: 43889.85","ShareWomen: 0.41599758<br />Median: 43532.98","ShareWomen: 0.42728240<br />Median: 43176.12","ShareWomen: 0.43856722<br />Median: 42819.26","ShareWomen: 0.44985204<br />Median: 42462.39","ShareWomen: 0.46113685<br />Median: 42105.53","ShareWomen: 0.47242167<br />Median: 41748.66","ShareWomen: 0.48370649<br />Median: 41391.80","ShareWomen: 0.49499131<br />Median: 41034.94","ShareWomen: 0.50627613<br />Median: 40678.07","ShareWomen: 0.51756095<br />Median: 40321.21","ShareWomen: 0.52884576<br />Median: 39964.35","ShareWomen: 0.54013058<br />Median: 39607.48","ShareWomen: 0.55141540<br />Median: 39250.62","ShareWomen: 0.56270022<br />Median: 38893.76","ShareWomen: 0.57398504<br />Median: 38536.89","ShareWomen: 0.58526986<br />Median: 38180.03","ShareWomen: 0.59655467<br />Median: 37823.16","ShareWomen: 0.60783949<br />Median: 37466.30","ShareWomen: 0.61912431<br />Median: 37109.44","ShareWomen: 0.63040913<br />Median: 36752.57","ShareWomen: 0.64169395<br />Median: 36395.71","ShareWomen: 0.65297877<br />Median: 36038.85","ShareWomen: 0.66426359<br />Median: 35681.98","ShareWomen: 0.67554840<br />Median: 35325.12","ShareWomen: 0.68683322<br />Median: 34968.25","ShareWomen: 0.69811804<br />Median: 34611.39","ShareWomen: 0.70940286<br />Median: 34254.53","ShareWomen: 0.72068768<br />Median: 33897.66","ShareWomen: 0.73197250<br />Median: 33540.80","ShareWomen: 0.74325731<br />Median: 33183.94","ShareWomen: 0.75454213<br />Median: 32827.07","ShareWomen: 0.76582695<br />Median: 32470.21","ShareWomen: 0.77711177<br />Median: 32113.34","ShareWomen: 0.78839659<br />Median: 31756.48","ShareWomen: 0.79968141<br />Median: 31399.62","ShareWomen: 0.81096622<br />Median: 31042.75","ShareWomen: 0.82225104<br />Median: 30685.89","ShareWomen: 0.83353586<br />Median: 30329.03","ShareWomen: 0.84482068<br />Median: 29972.16","ShareWomen: 0.85610550<br />Median: 29615.30","ShareWomen: 0.86739032<br />Median: 29258.44","ShareWomen: 0.87867514<br />Median: 28901.57","ShareWomen: 0.88995995<br />Median: 28544.71","ShareWomen: 0.90124477<br />Median: 28187.84","ShareWomen: 0.91252959<br />Median: 27830.98","ShareWomen: 0.92381441<br />Median: 27474.12","ShareWomen: 0.93509923<br />Median: 27117.25","ShareWomen: 0.94638405<br />Median: 26760.39","ShareWomen: 0.95766886<br />Median: 26403.53","ShareWomen: 0.96895368<br />Median: 26046.66"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.077453026999999994,0.088737845430379741,0.10002266386075949,0.11130748229113924,0.12259230072151897,0.13387711915189873,0.14516193758227847,0.15644675601265823,0.16773157444303796,0.1790163928734177,0.19030121130379746,0.20158602973417722,0.21287084816455693,0.22415566659493669,0.23544048502531645,0.24672530345569621,0.25801012188607592,0.26929494031645568,0.28057975874683544,0.29186457717721515,0.30314939560759491,0.31443421403797467,0.32571903246835443,0.33700385089873419,0.3482886693291139,0.35957348775949366,0.37085830618987342,0.38214312462025313,0.39342794305063289,0.40471276148101265,0.41599757991139241,0.42728239834177212,0.43856721677215188,0.44985203520253164,0.46113685363291135,0.47242167206329111,0.48370649049367087,0.49499130892405063,0.50627612735443028,0.51756094578481004,0.52884576421518981,0.54013058264556957,0.55141540107594933,0.56270021950632909,0.57398503793670885,0.58526985636708861,0.59655467479746838,0.60783949322784803,0.61912431165822779,0.63040913008860755,0.64169394851898731,0.65297876694936707,0.66426358537974683,0.6755484038101266,0.68683322224050625,0.69811804067088601,0.70940285910126577,0.72068767753164553,0.73197249596202529,0.74325731439240506,0.75454213282278482,0.76582695125316447,0.77711176968354423,0.78839658811392399,0.79968140654430375,0.81096622497468351,0.82225104340506328,0.83353586183544304,0.84482068026582269,0.85610549869620245,0.86739031712658221,0.87867513555696197,0.88995995398734173,0.9012447724177215,0.91252959084810126,0.92381440927848091,0.93509922770886067,0.94638404613924043,0.95766886456962019,0.96895368299999995,0.96895368299999995,0.96895368299999995,0.95766886456962019,0.94638404613924043,0.93509922770886067,0.92381440927848091,0.91252959084810126,0.9012447724177215,0.88995995398734173,0.87867513555696197,0.86739031712658221,0.85610549869620245,0.84482068026582269,0.83353586183544304,0.82225104340506328,0.81096622497468351,0.79968140654430375,0.78839658811392399,0.77711176968354423,0.76582695125316447,0.75454213282278482,0.74325731439240506,0.73197249596202529,0.72068767753164553,0.70940285910126577,0.69811804067088601,0.68683322224050625,0.6755484038101266,0.66426358537974683,0.65297876694936707,0.64169394851898731,0.63040913008860755,0.61912431165822779,0.60783949322784803,0.59655467479746838,0.58526985636708861,0.57398503793670885,0.56270021950632909,0.55141540107594933,0.54013058264556957,0.52884576421518981,0.51756094578481004,0.50627612735443028,0.49499130892405063,0.48370649049367087,0.47242167206329111,0.46113685363291135,0.44985203520253164,0.43856721677215188,0.42728239834177212,0.41599757991139241,0.40471276148101265,0.39342794305063289,0.38214312462025313,0.37085830618987342,0.35957348775949366,0.3482886693291139,0.33700385089873419,0.32571903246835443,0.31443421403797467,0.30314939560759491,0.29186457717721515,0.28057975874683544,0.26929494031645568,0.25801012188607592,0.24672530345569621,0.23544048502531645,0.22415566659493669,0.21287084816455693,0.20158602973417722,0.19030121130379746,0.1790163928734177,0.16773157444303796,0.15644675601265823,0.14516193758227847,0.13387711915189873,0.12259230072151897,0.11130748229113924,0.10002266386075949,0.088737845430379741,0.077453026999999994,0.077453026999999994],"y":[51251.457446047272,50954.251399195055,50656.716253835148,50358.831160842456,50060.573611476873,49761.91928588973,49462.84188728936,49163.312960633739,48863.301694729613,48562.774706671757,48261.69580766993,47960.025749504894,47657.721951156025,47354.738205584668,47051.024367279933,46746.526022027749,46441.18414150743,46134.934726819709,45827.708446980905,45519.430280854656,45210.019174007706,44899.38772562339,44587.44192490408,44274.080961298074,43959.197138255258,43642.6759257663,43324.396192197069,43004.230660181493,42682.046633598125,42357.707041681912,42031.071840670789,41701.99980158831,41370.350693610511,41035.987845415351,40698.781032573526,40358.609599615178,40015.365684946577,39668.957381032742,39319.311637919651,38966.376711648467,38610.12397487511,38250.548946024341,37887.671452179799,37521.534912083822,37152.204798808314,36779.766406116105,36404.322089479268,36025.988177139072,35644.891747897862,35261.167453863403,34874.954534006632,34486.394124921972,34095.626934805397,33702.791310104883,33308.021694422147,32911.447457201582,32513.192055355878,32113.372483230742,31712.098963791985,31309.474835148343,30905.596590172623,30500.55403196796,30094.430513435203,29687.303234675273,29279.243577057943,28870.317457318804,28460.585688932828,28050.104341255355,27638.925089563167,27227.095551235998,26814.659604968296,26401.657691167129,25988.127092645358,25574.102195420648,25159.614729933732,24744.693993347944,24329.367053821847,23913.658937787328,23497.592801339593,23081.190086870985,23081.190086870985,29012.133831490435,29309.458518944801,29607.119784420047,29905.139070308509,30203.539532705392,30502.346198042578,30801.586134478643,31101.288639176913,31401.485442578123,31702.21093069993,32003.502386355209,32305.400249951021,32607.948400181805,32911.194454427314,33215.190087964322,33519.991370148156,33825.659114453803,34132.259237616854,34439.863121007082,34748.547964725389,35058.39712167265,35369.500394951989,35681.954277436213,35995.862107234054,36311.334107311333,36628.48727201375,36947.445058253979,37268.336835476446,37591.297047282853,37916.464040121173,38243.978522187383,38573.981630075905,38906.612602757676,39242.006092340445,39580.28917762659,39921.578186857361,40265.975475504834,40613.566337331838,40964.416245410277,41318.568618482488,41676.043283632112,42036.835759283909,42400.917418093784,42768.23651610293,43138.72000335731,43512.275972321942,43888.796561403084,44268.161115130904,44650.239409076086,45034.894771916588,45421.986972828447,45811.374782835213,46202.918158174827,46596.480028082231,46991.927696435967,47389.133885869989,47787.977464750154,48188.343903067129,48590.1255042708,48993.221457809464,49397.537752885495,49802.986988682213,50209.48811076639,50616.966098001649,51025.351619404311,51434.580676075107,51844.594239693353,52255.337896044977,52666.76149961909,53078.818843377019,53491.467346298174,53904.667760163298,54318.383896182153,54732.582371449513,55147.232374772124,55562.305451107961,55977.775303665345,56393.617612595634,56809.809869158707,57226.331224229471,51251.457446047272],"text":["ShareWomen: 0.07745303<br />Median: 54238.89","ShareWomen: 0.08873785<br />Median: 53882.03","ShareWomen: 0.10002266<br />Median: 53525.17","ShareWomen: 0.11130748<br />Median: 53168.30","ShareWomen: 0.12259230<br />Median: 52811.44","ShareWomen: 0.13387712<br />Median: 52454.58","ShareWomen: 0.14516194<br />Median: 52097.71","ShareWomen: 0.15644676<br />Median: 51740.85","ShareWomen: 0.16773157<br />Median: 51383.98","ShareWomen: 0.17901639<br />Median: 51027.12","ShareWomen: 0.19030121<br />Median: 50670.26","ShareWomen: 0.20158603<br />Median: 50313.39","ShareWomen: 0.21287085<br />Median: 49956.53","ShareWomen: 0.22415567<br />Median: 49599.67","ShareWomen: 0.23544049<br />Median: 49242.80","ShareWomen: 0.24672530<br />Median: 48885.94","ShareWomen: 0.25801012<br />Median: 48529.08","ShareWomen: 0.26929494<br />Median: 48172.21","ShareWomen: 0.28057976<br />Median: 47815.35","ShareWomen: 0.29186458<br />Median: 47458.48","ShareWomen: 0.30314940<br />Median: 47101.62","ShareWomen: 0.31443421<br />Median: 46744.76","ShareWomen: 0.32571903<br />Median: 46387.89","ShareWomen: 0.33700385<br />Median: 46031.03","ShareWomen: 0.34828867<br />Median: 45674.17","ShareWomen: 0.35957349<br />Median: 45317.30","ShareWomen: 0.37085831<br />Median: 44960.44","ShareWomen: 0.38214312<br />Median: 44603.57","ShareWomen: 0.39342794<br />Median: 44246.71","ShareWomen: 0.40471276<br />Median: 43889.85","ShareWomen: 0.41599758<br />Median: 43532.98","ShareWomen: 0.42728240<br />Median: 43176.12","ShareWomen: 0.43856722<br />Median: 42819.26","ShareWomen: 0.44985204<br />Median: 42462.39","ShareWomen: 0.46113685<br />Median: 42105.53","ShareWomen: 0.47242167<br />Median: 41748.66","ShareWomen: 0.48370649<br />Median: 41391.80","ShareWomen: 0.49499131<br />Median: 41034.94","ShareWomen: 0.50627613<br />Median: 40678.07","ShareWomen: 0.51756095<br />Median: 40321.21","ShareWomen: 0.52884576<br />Median: 39964.35","ShareWomen: 0.54013058<br />Median: 39607.48","ShareWomen: 0.55141540<br />Median: 39250.62","ShareWomen: 0.56270022<br />Median: 38893.76","ShareWomen: 0.57398504<br />Median: 38536.89","ShareWomen: 0.58526986<br />Median: 38180.03","ShareWomen: 0.59655467<br />Median: 37823.16","ShareWomen: 0.60783949<br />Median: 37466.30","ShareWomen: 0.61912431<br />Median: 37109.44","ShareWomen: 0.63040913<br />Median: 36752.57","ShareWomen: 0.64169395<br />Median: 36395.71","ShareWomen: 0.65297877<br />Median: 36038.85","ShareWomen: 0.66426359<br />Median: 35681.98","ShareWomen: 0.67554840<br />Median: 35325.12","ShareWomen: 0.68683322<br />Median: 34968.25","ShareWomen: 0.69811804<br />Median: 34611.39","ShareWomen: 0.70940286<br />Median: 34254.53","ShareWomen: 0.72068768<br />Median: 33897.66","ShareWomen: 0.73197250<br />Median: 33540.80","ShareWomen: 0.74325731<br />Median: 33183.94","ShareWomen: 0.75454213<br />Median: 32827.07","ShareWomen: 0.76582695<br />Median: 32470.21","ShareWomen: 0.77711177<br />Median: 32113.34","ShareWomen: 0.78839659<br />Median: 31756.48","ShareWomen: 0.79968141<br />Median: 31399.62","ShareWomen: 0.81096622<br />Median: 31042.75","ShareWomen: 0.82225104<br />Median: 30685.89","ShareWomen: 0.83353586<br />Median: 30329.03","ShareWomen: 0.84482068<br />Median: 29972.16","ShareWomen: 0.85610550<br />Median: 29615.30","ShareWomen: 0.86739032<br />Median: 29258.44","ShareWomen: 0.87867514<br />Median: 28901.57","ShareWomen: 0.88995995<br />Median: 28544.71","ShareWomen: 0.90124477<br />Median: 28187.84","ShareWomen: 0.91252959<br />Median: 27830.98","ShareWomen: 0.92381441<br />Median: 27474.12","ShareWomen: 0.93509923<br />Median: 27117.25","ShareWomen: 0.94638405<br />Median: 26760.39","ShareWomen: 0.95766886<br />Median: 26403.53","ShareWomen: 0.96895368<br />Median: 26046.66","ShareWomen: 0.96895368<br />Median: 26046.66","ShareWomen: 0.96895368<br />Median: 26046.66","ShareWomen: 0.95766886<br />Median: 26403.53","ShareWomen: 0.94638405<br />Median: 26760.39","ShareWomen: 0.93509923<br />Median: 27117.25","ShareWomen: 0.92381441<br />Median: 27474.12","ShareWomen: 0.91252959<br />Median: 27830.98","ShareWomen: 0.90124477<br />Median: 28187.84","ShareWomen: 0.88995995<br />Median: 28544.71","ShareWomen: 0.87867514<br />Median: 28901.57","ShareWomen: 0.86739032<br />Median: 29258.44","ShareWomen: 0.85610550<br />Median: 29615.30","ShareWomen: 0.84482068<br />Median: 29972.16","ShareWomen: 0.83353586<br />Median: 30329.03","ShareWomen: 0.82225104<br />Median: 30685.89","ShareWomen: 0.81096622<br />Median: 31042.75","ShareWomen: 0.79968141<br />Median: 31399.62","ShareWomen: 0.78839659<br />Median: 31756.48","ShareWomen: 0.77711177<br />Median: 32113.34","ShareWomen: 0.76582695<br />Median: 32470.21","ShareWomen: 0.75454213<br />Median: 32827.07","ShareWomen: 0.74325731<br />Median: 33183.94","ShareWomen: 0.73197250<br />Median: 33540.80","ShareWomen: 0.72068768<br />Median: 33897.66","ShareWomen: 0.70940286<br />Median: 34254.53","ShareWomen: 0.69811804<br />Median: 34611.39","ShareWomen: 0.68683322<br />Median: 34968.25","ShareWomen: 0.67554840<br />Median: 35325.12","ShareWomen: 0.66426359<br />Median: 35681.98","ShareWomen: 0.65297877<br />Median: 36038.85","ShareWomen: 0.64169395<br />Median: 36395.71","ShareWomen: 0.63040913<br />Median: 36752.57","ShareWomen: 0.61912431<br />Median: 37109.44","ShareWomen: 0.60783949<br />Median: 37466.30","ShareWomen: 0.59655467<br />Median: 37823.16","ShareWomen: 0.58526986<br />Median: 38180.03","ShareWomen: 0.57398504<br />Median: 38536.89","ShareWomen: 0.56270022<br />Median: 38893.76","ShareWomen: 0.55141540<br />Median: 39250.62","ShareWomen: 0.54013058<br />Median: 39607.48","ShareWomen: 0.52884576<br />Median: 39964.35","ShareWomen: 0.51756095<br />Median: 40321.21","ShareWomen: 0.50627613<br />Median: 40678.07","ShareWomen: 0.49499131<br />Median: 41034.94","ShareWomen: 0.48370649<br />Median: 41391.80","ShareWomen: 0.47242167<br />Median: 41748.66","ShareWomen: 0.46113685<br />Median: 42105.53","ShareWomen: 0.44985204<br />Median: 42462.39","ShareWomen: 0.43856722<br />Median: 42819.26","ShareWomen: 0.42728240<br />Median: 43176.12","ShareWomen: 0.41599758<br />Median: 43532.98","ShareWomen: 0.40471276<br />Median: 43889.85","ShareWomen: 0.39342794<br />Median: 44246.71","ShareWomen: 0.38214312<br />Median: 44603.57","ShareWomen: 0.37085831<br />Median: 44960.44","ShareWomen: 0.35957349<br />Median: 45317.30","ShareWomen: 0.34828867<br />Median: 45674.17","ShareWomen: 0.33700385<br />Median: 46031.03","ShareWomen: 0.32571903<br />Median: 46387.89","ShareWomen: 0.31443421<br />Median: 46744.76","ShareWomen: 0.30314940<br />Median: 47101.62","ShareWomen: 0.29186458<br />Median: 47458.48","ShareWomen: 0.28057976<br />Median: 47815.35","ShareWomen: 0.26929494<br />Median: 48172.21","ShareWomen: 0.25801012<br />Median: 48529.08","ShareWomen: 0.24672530<br />Median: 48885.94","ShareWomen: 0.23544049<br />Median: 49242.80","ShareWomen: 0.22415567<br />Median: 49599.67","ShareWomen: 0.21287085<br />Median: 49956.53","ShareWomen: 0.20158603<br />Median: 50313.39","ShareWomen: 0.19030121<br />Median: 50670.26","ShareWomen: 0.17901639<br />Median: 51027.12","ShareWomen: 0.16773157<br />Median: 51383.98","ShareWomen: 0.15644676<br />Median: 51740.85","ShareWomen: 0.14516194<br />Median: 52097.71","ShareWomen: 0.13387712<br />Median: 52454.58","ShareWomen: 0.12259230<br />Median: 52811.44","ShareWomen: 0.11130748<br />Median: 53168.30","ShareWomen: 0.10002266<br />Median: 53525.17","ShareWomen: 0.08873785<br />Median: 53882.03","ShareWomen: 0.07745303<br />Median: 54238.89","ShareWomen: 0.07745303<br />Median: 54238.89"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Median income by the proportion of women in each major","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.032877994199999996,1.0135287157999999],"tickmode":"array","ticktext":["25%","50%","75%","100%"],"tickvals":[0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["25%","50%","75%","100%"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Proportion of women with major","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5500,115500],"tickmode":"array","ticktext":["$0","$30,000","$60,000","$90,000"],"tickvals":[0,30000,60000,90000],"categoryorder":"array","categoryarray":["$0","$30,000","$60,000","$90,000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Median","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Major_category<br />Total","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3f507313e274":{"x":{},"y":{},"label":{},"size":{},"colour":{},"type":"scatter"},"3f501e7868b2":{"x":{},"y":{},"label":{}},"3f5073218dbe":{"y":{}}},"cur_data":"3f507313e274","visdat":{"3f507313e274":["function (y) ","x"],"3f501e7868b2":["function (y) ","x"],"3f5073218dbe":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s run a regression analysis to see if the proportion of women in the major is correlated with salary. It looks like every percentage point increase in the proportion of women in a particular major is correlated with a $23,650 decrease in salary.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-41_0731c8e92b0d36846d9150d3adea9071">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Median <span class="sc">~</span> ShareWomen, <span class="at">data =</span> grads, <span class="at">weights =</span> Sample_size) <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Median ~ ShareWomen, data = grads, weights = Sample_size)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-260544  -61278  -13324   33834  865216 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    52079       1441  36.147   &lt;2e-16
ShareWomen    -23660       2410  -9.816   &lt;2e-16

Residual standard error: 123300 on 169 degrees of freedom
Multiple R-squared:  0.3631,    Adjusted R-squared:  0.3594 
F-statistic: 96.36 on 1 and 169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Let’s run a similar analysis looking at the median income as a function of the percentage of majors getting a job requiring a college degree.</p>
<div class="cell" data-hash="tidyeda_cache/html/unnamed-chunk-42_bb97b9f40c7135154ba5796071b2f31e">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Major_category =</span> <span class="fu">fct_lump</span>(Major_category, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pct_college, Median)) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Total, <span class="at">col=</span>Major_category)) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label=</span><span class="fu">percent_format</span>()) <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label=</span><span class="fu">dollar_format</span>()) <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">label=</span><span class="fu">number_format</span>()) <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"% of Major's Grads Employed in Jobs Requiring a College Degree"</span>, </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Median salary"</span>, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Median income by percent with jobs requiring a college degree"</span>, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Adapted from @backerman150"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tidyeda_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Here’s Table 2 in the <a href="https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/">FiveThirtyEight piece</a>. It uses the <code>mutate_at</code> function to run an arbitrary function on any number of variables defined in the <code>vars()</code> function. See the help for <code>?mutate_at</code> to learn more.</p>
<div class="cell" data-hash="tidyeda_cache/html/datatable-538-2_a7f760ca62c0f6966a6f777029d0ed9c">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>grads <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Major, Total, Median, P25th, P75th, Part_time, Non_college_jobs, Low_wage_jobs) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Part_time, Non_college_jobs, Low_wage_jobs), <span class="fu">funs</span>(<span class="fu">percent</span>(.<span class="sc">/</span>Total))) <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Median, P25th, P75th), <span class="fu">funs</span>(dollar)) <span class="sc">|&gt;</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-44742b7bc605b72cc45b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-44742b7bc605b72cc45b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["Petroleum Engineering","Mining And Mineral Engineering","Metallurgical Engineering","Naval Architecture And Marine Engineering","Chemical Engineering","Nuclear Engineering","Actuarial Science","Astronomy And Astrophysics","Mechanical Engineering","Electrical Engineering","Computer Engineering","Aerospace Engineering","Biomedical Engineering","Materials Science","Engineering Mechanics Physics And Science","Biological Engineering","Industrial And Manufacturing Engineering","General Engineering","Architectural Engineering","Court Reporting","Computer Science","Electrical Engineering Technology","Materials Engineering And Materials Science","Management Information Systems And Statistics","Civil Engineering","Construction Services","Operations Logistics And E-Commerce","Miscellaneous Engineering","Public Policy","Environmental Engineering","Engineering Technologies","Miscellaneous Fine Arts","Geological And Geophysical Engineering","Nursing","Finance","Economics","Business Economics","Industrial Production Technologies","Nuclear, Industrial Radiology, And Biological Technologies","Accounting","Mathematics","Computer And Information Systems","Physics","Medical Technologies Technicians","Information Sciences","Statistics And Decision Science","Applied Mathematics","Pharmacology","Oceanography","Engineering And Industrial Management","Medical Assisting Services","Mathematics And Computer Science","Computer Programming And Data Processing","Cognitive Science And Biopsychology","School Student Counseling","International Relations","General Business","Architecture","International Business","Pharmacy Pharmaceutical Sciences And Administration","Molecular Biology","Miscellaneous Business &amp; Medical Administration","Agriculture Production And Management","General Agriculture","Miscellaneous Engineering Technologies","Mechanical Engineering Related Technologies","Genetics","Miscellaneous Social Sciences","United States History","Industrial And Organizational Psychology","Agricultural Economics","Physical Sciences","Chemistry","Electrical, Mechanical, And Precision Technologies And Production","Business Management And Administration","Marketing And Marketing Research","Political Science And Government","Geography","Microbiology","Computer Administration Management And Security","Biochemical Sciences","Botany","Computer Networking And Telecommunications","Geology And Earth Science","Human Resources And Personnel Management","Pre-Law And Legal Studies","Miscellaneous Health Medical Professions","Public Administration","Geosciences","Social Psychology","Environmental Science","Communications","Criminal Justice And Fire Protection","Commercial Art And Graphic Design","Journalism","Multi-Disciplinary Or General Science","Advertising And Public Relations","Area Ethnic And Civilization Studies","Special Needs Education","Physiology","Criminology","Nutrition Sciences","Health And Medical Administrative Services","Communication Technologies","Transportation Sciences And Technologies","Natural Resources Management","Neuroscience","Multi/Interdisciplinary Studies","Atmospheric Sciences And Meteorology","Forestry","Soil Science","General Education","History","French German Latin And Other Common Foreign Language Studies","Intercultural And International Studies","Social Science Or History Teacher Education","Community And Public Health","Mathematics Teacher Education","Educational Administration And Supervision","Health And Medical Preparatory Programs","Miscellaneous Biology","Biology","Sociology","Mass Media","Treatment Therapy Professions","Hospitality Management","Language And Drama Education","Linguistics And Comparative Language And Literature","Miscellaneous Education","Interdisciplinary Social Sciences","Ecology","Secondary Teacher Education","General Medical And Health Services","Philosophy And Religious Studies","Art And Music Education","English Language And Literature","Elementary Education","Physical Fitness Parks Recreation And Leisure","Liberal Arts","Film Video And Photographic Arts","General Social Sciences","Plant Science And Agronomy","Science And Computer Teacher Education","Psychology","Music","Physical And Health Education Teaching","Art History And Criticism","Fine Arts","Family And Consumer Sciences","Social Work","Animal Sciences","Visual And Performing Arts","Teacher Education: Multiple Levels","Miscellaneous Psychology","Human Services And Community Organization","Humanities","Theology And Religious Vocations","Studio Arts","Cosmetology Services And Culinary Arts","Miscellaneous Agriculture","Anthropology And Archeology","Communication Disorders Sciences And Services","Early Childhood Education","Other Foreign Languages","Drama And Theater Arts","Composition And Rhetoric","Zoology","Educational Psychology","Clinical Psychology","Counseling Psychology","Library Science"],[2339,756,856,1258,32260,2573,3777,1792,91227,81527,41542,15058,14955,4279,4321,8925,18968,61152,2825,1148,128319,11565,2993,18713,53153,18498,11732,9133,5978,4047,3600,3340,720,209394,174506,139247,13302,4631,2116,198633,72397,36698,32142,15914,11913,6251,4939,1762,2418,2906,11123,609,4168,3831,818,28187,234590,46420,25894,23551,18300,17947,14240,10399,8804,4790,3635,3283,3079,3014,2439,1436,66530,2435,329927,205211,182621,18480,15232,8066,39107,1329,7613,10972,24497,13528,13386,5629,1978,1386,25965,213996,152824,103480,72619,62052,53162,31195,28739,22060,19879,18909,18109,18035,15150,13773,13663,12296,4043,3607,685,143718,141951,48246,24650,20198,19735,14237,804,12740,10706,280709,115433,52824,48491,43647,30471,16601,10150,9916,9154,17125,33599,54814,34181,194673,170862,125074,71369,38761,12920,7416,6483,393735,60633,28213,21030,74440,58001,53552,21573,16250,14443,9628,9374,6652,30207,16977,10510,1488,38844,38279,37589,11204,43249,18953,8409,2854,2838,4626,1098],["$110,000","$75,000","$73,000","$70,000","$65,000","$65,000","$62,000","$62,000","$60,000","$60,000","$60,000","$60,000","$60,000","$60,000","$58,000","$57,100","$57,000","$56,000","$54,000","$54,000","$53,000","$52,000","$52,000","$51,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$48,000","$47,000","$47,000","$46,000","$46,000","$46,000","$45,000","$45,000","$45,000","$45,000","$45,000","$45,000","$45,000","$45,000","$45,000","$44,700","$44,000","$42,000","$42,000","$41,300","$41,000","$41,000","$40,100","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$40,000","$39,000","$38,400","$38,000","$38,000","$38,000","$38,000","$38,000","$37,500","$37,400","$37,000","$36,400","$36,200","$36,000","$36,000","$36,000","$36,000","$36,000","$36,000","$35,600","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$35,000","$34,000","$34,000","$34,000","$34,000","$34,000","$34,000","$34,000","$34,000","$33,500","$33,500","$33,400","$33,000","$33,000","$33,000","$33,000","$33,000","$33,000","$33,000","$33,000","$33,000","$32,500","$32,400","$32,200","$32,100","$32,000","$32,000","$32,000","$32,000","$32,000","$32,000","$32,000","$32,000","$31,500","$31,000","$31,000","$31,000","$30,500","$30,000","$30,000","$30,000","$30,000","$30,000","$30,000","$30,000","$30,000","$29,000","$29,000","$29,000","$29,000","$28,000","$28,000","$28,000","$27,500","$27,000","$27,000","$26,000","$25,000","$25,000","$23,400","$22,000"],["$95,000","$55,000","$50,000","$43,000","$50,000","$50,000","$53,000","$31,500","$48,000","$45,000","$45,000","$42,000","$36,000","$39,000","$25,000","$40,000","$37,900","$36,000","$38,000","$50,000","$39,000","$35,000","$35,000","$38,000","$40,000","$36,000","$40,000","$39,000","$35,000","$42,000","$43,000","$25,000","$42,800","$39,000","$35,000","$35,000","$33,000","$35,000","$38,000","$34,000","$33,000","$30,000","$30,000","$36,000","$32,500","$26,700","$34,000","$40,000","$23,000","$30,000","$30,000","$30,000","$20,000","$20,000","$41,000","$31,200","$30,000","$31,000","$30,000","$20,000","$29,000","$30,000","$25,000","$30,000","$30,400","$27,000","$34,000","$30,000","$30,000","$32,000","$27,000","$30,000","$30,000","$22,500","$29,000","$30,000","$28,000","$30,000","$29,600","$25,000","$29,000","$26,000","$27,000","$28,000","$28,000","$29,200","$23,000","$23,000","$21,000","$34,000","$25,000","$27,000","$26,000","$25,000","$26,000","$24,000","$27,000","$24,500","$32,000","$20,000","$25,000","$26,000","$27,000","$25,000","$22,000","$25,000","$30,000","$25,000","$28,000","$28,600","$18,500","$26,000","$25,000","$25,000","$24,000","$23,050","$21,000","$30,000","$29,000","$23,000","$23,000","$24,000","$25,000","$25,000","$24,000","$25,000","$24,000","$25,000","$30,000","$24,000","$23,000","$25,000","$25,000","$23,000","$25,000","$23,000","$23,400","$24,000","$25,000","$22,000","$27,000","$22,900","$28,000","$24,000","$22,300","$24,000","$23,000","$21,000","$22,900","$25,000","$22,000","$22,000","$24,000","$20,800","$24,000","$20,000","$22,000","$19,200","$20,000","$23,000","$20,000","$20,000","$21,000","$22,900","$19,200","$20,000","$20,000","$24,000","$25,000","$19,200","$20,000"],["$125,000","$90,000","$105,000","$80,000","$75,000","$102,000","$72,000","$109,000","$70,000","$72,000","$75,000","$70,000","$70,000","$65,000","$74,000","$76,000","$67,000","$69,000","$65,000","$54,000","$70,000","$60,000","$62,000","$60,000","$60,000","$60,000","$60,000","$65,000","$70,000","$56,000","$60,000","$66,000","$57,000","$58,000","$64,000","$65,000","$58,000","$65,000","$53,000","$56,000","$60,000","$60,000","$68,000","$50,000","$58,000","$60,000","$63,000","$45,000","$50,000","$50,000","$65,000","$78,000","$46,000","$60,000","$43,000","$53,000","$55,000","$50,000","$50,000","$90,000","$47,000","$51,000","$50,000","$50,000","$56,000","$52,000","$45,000","$54,000","$42,000","$53,000","$54,000","$55,000","$49,900","$45,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$50,000","$40,000","$49,000","$47,000","$45,000","$46,000","$42,000","$60,000","$41,000","$45,000","$40,200","$45,000","$45,000","$45,000","$42,900","$50,000","$47,000","$44,000","$42,000","$50,000","$45,000","$45,000","$42,000","$45,000","$52,000","$42,000","$44,000","$44,000","$50,000","$48,000","$44,000","$41,000","$47,000","$45,000","$45,000","$42,000","$45,000","$40,000","$35,000","$40,000","$48,000","$45,000","$44,000","$45,000","$41,000","$42,000","$40,000","$40,000","$45,000","$40,000","$42,000","$38,000","$45,000","$47,100","$40,000","$41,000","$38,000","$43,000","$42,000","$42,000","$50,000","$40,000","$39,000","$41,000","$42,000","$40,000","$40,000","$41,000","$40,000","$35,000","$40,000","$40,000","$37,000","$40,000","$35,000","$49,000","$38,000","$38,300","$36,000","$42,100","$38,000","$40,000","$35,000","$38,000","$35,000","$35,000","$39,000","$34,000","$40,000","$26,000","$22,000"],["11.5434%","22.4868%","15.5374%","11.9237%","16.0570%","10.2604%","7.8369%","30.8594%","14.3609%","15.5715%","12.3875%","18.0901%","18.0140%","20.5188%","18.7688%","22.2185%","11.8252%","11.7723%","12.1416%","19.4251%","14.5933%","16.1954%","34.7477%","12.9322%","18.9641%","9.4659%","10.0835%","18.1977%","21.8468%","22.9800%","19.1389%","31.9461%","17.5000%","19.4934%","12.2993%","18.1871%","14.5617%","12.8914%","27.3629%","13.9418%","24.9720%","11.8045%","27.1327%","16.7463%","12.3227%","29.4353%","23.8105%","30.1930%","15.6741%","15.8981%","36.9235%","0.0000%","11.5643%","18.5591%","16.5037%","19.7360%","15.4487%","21.9862%","18.8847%","22.6997%","25.0820%","18.7552%","15.4213%","19.5307%","14.0845%","5.1566%","23.3012%","27.6272%","27.2491%","36.3305%","25.4203%","30.4318%","22.6454%","11.7864%","15.2631%","17.4596%","23.9354%","30.5790%","22.1836%","12.7697%","25.4379%","12.7163%","19.0070%","26.5494%","15.3774%","26.5745%","30.9652%","15.0471%","17.8969%","31.2410%","27.2328%","23.3131%","21.0975%","23.5669%","21.8979%","21.1645%","20.5937%","30.5850%","17.9303%","29.6510%","22.8533%","35.1579%","18.2175%","26.0050%","17.3795%","18.9719%","22.5280%","25.8051%","32.3769%","24.7020%","27.0073%","20.5667%","28.6416%","30.1973%","32.3651%","25.5867%","32.3131%","15.9654%","0.0000%","30.5416%","23.9865%","25.7815%","25.6764%","24.7577%","25.4604%","17.1696%","23.7570%","29.1007%","21.6946%","28.5801%","29.9432%","22.0847%","33.0010%","30.3919%","26.9419%","29.7037%","22.2197%","30.7938%","26.8842%","33.0693%","26.2848%","16.8015%","18.9264%","29.2511%","41.1377%","25.6265%","29.1964%","31.7786%","27.3650%","25.1737%","24.8134%","38.4800%","15.3292%","33.4545%","25.6561%","33.4486%","29.0231%","33.4158%","19.6384%","22.5134%","37.3674%","36.2131%","18.6251%","32.8900%","36.9812%","34.8863%","26.0435%","20.0420%","22.8330%","20.8604%","21.5847%"],["15.5622%","33.9947%","20.5607%","8.1081%","13.7632%","25.5344%","8.3135%","27.9018%","17.9596%","13.3379%","13.7716%","16.1044%","16.5229%","9.1376%","21.9162%","17.8711%","17.0550%","19.1883%","22.9735%","45.9930%","20.0025%","23.2252%","10.1904%","30.6792%","17.6020%","28.9275%","30.9325%","26.5630%","31.2981%","20.5090%","35.2500%","51.3174%","6.9444%","12.4865%","27.7624%","26.6124%","34.6715%","52.9907%","69.7070%","19.7968%","20.4829%","32.1080%","14.2368%","45.0924%","34.4330%","19.1969%","16.2584%","27.1283%","41.1911%","29.0434%","62.4652%","11.0016%","24.7841%","24.0407%","27.0171%","33.9518%","42.9818%","29.5648%","36.6185%","19.0777%","17.1858%","49.7966%","43.6868%","45.3601%","44.2526%","44.2797%","18.6520%","50.3807%","51.6726%","40.6105%","36.6134%","32.3816%","22.1224%","68.1314%","44.9781%","45.7524%","36.6590%","36.9589%","20.8377%","40.2182%","21.4642%","13.8450%","38.6313%","25.4466%","39.3069%","47.7085%","28.6493%","41.0908%","29.8787%","42.7850%","38.8061%","45.7784%","58.1440%","36.8371%","36.7287%","35.5170%","43.3750%","37.8843%","13.2120%","31.2511%","53.3478%","28.9439%","47.4460%","48.7607%","40.5743%","42.1695%","16.8411%","31.7420%","32.5748%","46.9088%","21.0219%","21.6479%","38.4421%","37.7088%","41.9594%","27.5324%","37.4208%","13.8864%","25.6219%","27.7786%","25.4250%","28.8943%","42.3614%","47.8892%","30.1417%","53.4768%","22.3951%","34.3052%","24.0197%","39.3909%","45.4337%","23.1650%","38.3613%","37.0581%","24.1655%","36.8962%","21.6385%","51.1265%","40.0146%","53.4584%","36.9814%","47.8020%","17.0600%","36.0293%","47.4758%","33.0628%","46.3053%","43.9616%","34.7115%","26.9196%","44.3656%","46.9846%","13.4944%","41.0054%","49.0186%","50.4209%","39.8484%","51.2870%","70.2569%","42.0699%","42.9745%","24.5670%","20.4980%","33.0507%","58.5285%","42.7373%","35.0458%","21.5487%","30.6554%","26.9131%","30.7832%"],["8.2514%","6.6138%","0.0000%","0.0000%","3.0130%","9.4831%","6.8573%","12.2768%","3.5658%","3.8883%","2.3591%","2.4704%","5.2758%","1.8930%","6.0866%","5.8711%","3.3741%","5.2198%","4.8496%","12.5436%","4.0088%","6.0182%","2.3388%","3.7835%","5.4541%","3.8004%","2.4293%","3.9965%","5.6875%","6.4245%","3.9444%","22.6048%","6.8056%","2.9576%","5.6789%","7.6504%","9.6527%","10.3649%","5.8601%","5.4805%","6.3110%","4.5561%","5.6717%","6.2963%","5.1037%","5.4871%","7.2282%","5.2781%","7.6923%","8.4308%","11.4178%","4.1051%","6.3100%","3.5239%","0.0000%","8.8658%","11.6459%","9.0931%","11.7633%","4.7599%","6.3825%","9.7955%","9.5646%","8.0681%","4.3844%","8.4760%","5.5296%","17.4535%","9.8084%","9.0246%","3.8540%","18.7326%","6.4452%","3.3265%","9.8188%","13.6289%","10.8438%","10.3084%","8.1801%","3.8185%","7.7019%","4.2137%","4.6237%","8.7404%","7.7805%","9.8758%","10.6230%","8.8115%","11.1729%","2.6696%","12.2280%","12.8227%","12.0426%","14.3400%","11.7215%","9.2680%","13.5698%","11.7871%","4.1024%","10.1405%","9.5327%","12.9515%","7.6813%","13.8342%","3.6766%","10.2011%","6.6018%","8.6288%","5.8620%","9.0657%","0.0000%","7.9621%","11.8625%","10.9170%","12.8519%","8.9415%","9.3945%","5.5208%","13.8060%","9.0973%","4.2873%","10.0955%","11.9099%","12.1706%","9.2141%","20.7643%","9.2514%","12.5595%","6.4729%","14.8245%","10.6620%","8.0876%","11.3575%","14.6879%","8.0951%","13.6141%","6.7317%","13.4624%","12.6526%","15.1234%","12.6471%","16.5992%","9.1161%","12.2435%","15.3151%","7.2378%","16.2910%","15.9592%","9.0481%","8.1117%","9.8503%","17.4769%","4.9990%","17.1375%","7.7235%","17.1527%","10.9379%","21.1227%","30.0951%","2.0833%","17.6758%","13.3885%","7.6299%","9.9518%","25.5913%","18.2873%","8.8358%","2.8732%","21.9168%","6.6580%","17.4863%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Major<\/th>\n      <th>Total<\/th>\n      <th>Median<\/th>\n      <th>P25th<\/th>\n      <th>P75th<\/th>\n      <th>Part_time<\/th>\n      <th>Non_college_jobs<\/th>\n      <th>Low_wage_jobs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Major","targets":1},{"name":"Total","targets":2},{"name":"Median","targets":3},{"name":"P25th","targets":4},{"name":"P75th","targets":5},{"name":"Part_time","targets":6},{"name":"Non_college_jobs","targets":7},{"name":"Low_wage_jobs","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ggplot2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rmarkdown.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reproducible Reporting with RMarkdown</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© 2018 Stephen D. Turner</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/strnr">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stephenturner">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/turnersd/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://stephenturner.us/">
      <i class="bi bi-house-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://blog.stephenturner.us/">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>